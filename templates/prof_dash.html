<!DOCTYPE html>
<html lang="fr">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="icon" href="img/logo.png" type="image/x-icon">
    <title>Dashboard Professeur - Kalanso</title>
    <link href="https://fonts.googleapis.com/css2?family=Noto+Serif:ital,wght@0,100..900;1,100..900&display=swap"
        rel="stylesheet">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <script src="https://kit.fontawesome.com/ca00bf51a9.js" crossorigin="anonymous"></script>
    <style>
        :root {
            --primary: #F4F1EB;
            --primary-light: #F9F7F4;
            --primary-dark: #E8E2D5;
            --primary-transparent: rgba(244, 241, 235, 0.1);
            --bg-dark: #1a1a1a;
            --bg-darker: #0f0f0f;
            --bg-card: #2d2d2d;
            --text-light: #ffffff;
            --text-muted: #a0a0a0;
            --border-color: #3d3d3d;
            --sidebar-width: 280px;
            --success: #10b981;
            --warning: #f59e0b;
            --danger: #ef4444;
            --info: #3b82f6;
        }

        [data-theme="light"] {
            --primary: #8B7355;
            --primary-light: #A08879;
            --primary-dark: #6B5842;
            --primary-transparent: rgba(139, 115, 85, 0.1);
            --bg-dark: #ffffff;
            --bg-darker: #f5f5f5;
            --bg-card: #ffffff;
            --text-light: #1a1a1a;
            --text-muted: #6b7280;
            --border-color: #e5e7eb;
        }

        * {
            font-family: "Noto Serif", serif;
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            background: var(--bg-darker);
            color: var(--text-light);
            transition: all 0.3s ease;
            min-height: 100vh;
        }

        /* Sidebar Styles */
        .sidebar {
            position: fixed;
            left: 0;
            top: 0;
            width: var(--sidebar-width);
            height: 100vh;
            background: var(--bg-dark);
            border-right: 1px solid var(--border-color);
            z-index: 1000;
            transition: all 0.3s ease;
            display: flex;
            flex-direction: column;
            overflow-y: auto;
        }

        .sidebar-header {
            padding: 1.5rem;
            border-bottom: 1px solid var(--border-color);
            display: flex;
            align-items: center;
            gap: 0.75rem;
        }

        .logo {
            font-size: 1.5rem;
            font-weight: bold;
            color: var(--primary);
            text-decoration: none;
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        .logo i {
            font-size: 1.75rem;
        }

        .sidebar-menu {
            padding: 1rem 0;
            flex: 1;
        }

        .menu-item {
            display: flex;
            align-items: center;
            padding: 0.875rem 1.5rem;
            color: var(--text-muted);
            text-decoration: none;
            transition: all 0.3s;
            border: none;
            background: none;
            width: 100%;
            text-align: left;
            cursor: pointer;
            position: relative;
            font-size: 0.95rem;
        }

        .menu-item:hover {
            background: var(--primary-transparent);
            color: var(--primary);
        }

        .menu-item.active {
            background: var(--primary-transparent);
            color: var(--primary);
            border-right: 3px solid var(--primary);
        }

        .menu-item i {
            width: 24px;
            margin-right: 0.75rem;
            font-size: 1.1rem;
        }

        .user-profile {
            padding: 1.5rem;
            border-top: 1px solid var(--border-color);
            margin-top: auto;
        }

        .user-info {
            display: flex;
            align-items: center;
            gap: 0.75rem;
            margin-bottom: 1rem;
        }

        .user-avatar {
            width: 45px;
            height: 45px;
            background: var(--primary);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: bold;
            color: var(--bg-dark);
            font-size: 1.1rem;
        }

        .user-details {
            flex: 1;
        }

        .user-name {
            font-weight: 600;
            color: var(--text-light);
            font-size: 0.95rem;
        }

        .user-role {
            font-size: 0.8rem;
            color: var(--text-muted);
        }

        /* Main Content Area */
        .main-content {
            margin-left: var(--sidebar-width);
            min-height: 100vh;
            transition: margin-left 0.3s ease;
        }

        .header {
            background: var(--bg-dark);
            border-bottom: 1px solid var(--border-color);
            padding: 1rem 2rem;
            display: flex;
            justify-content: space-between;
            align-items: center;
            position: sticky;
            top: 0;
            z-index: 999;
        }

        .header-left {
            display: flex;
            align-items: center;
            gap: 1rem;
        }

        .header-left h1 {
            font-size: 1.75rem;
            font-weight: 600;
            color: var(--text-light);
            margin: 0;
        }

        .header-right {
            display: flex;
            align-items: center;
            gap: 1rem;
        }

        .theme-toggle {
            background: none;
            border: 2px solid var(--primary);
            color: var(--primary);
            padding: 0.5rem;
            border-radius: 50%;
            cursor: pointer;
            transition: all 0.3s;
            width: 40px;
            height: 40px;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .theme-toggle:hover {
            background: var(--primary);
            color: var(--bg-dark);
        }

        .notifications {
            position: relative;
            background: none;
            border: none;
            color: var(--text-muted);
            font-size: 1.25rem;
            cursor: pointer;
            padding: 0.5rem;
            transition: color 0.3s;
        }

        .notifications:hover {
            color: var(--primary);
        }

        .notification-badge {
            position: absolute;
            top: 0;
            right: 0;
            background: var(--danger);
            color: white;
            border-radius: 50%;
            width: 20px;
            height: 20px;
            font-size: 0.75rem;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: bold;
        }

        /* Content Sections */
        .content-section {
            display: none;
            padding: 2rem;
            animation: fadeIn 0.5s ease-in;
        }

        .content-section.active {
            display: block;
        }

        @keyframes fadeIn {
            from {
                opacity: 0;
                transform: translateY(20px);
            }

            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        /* Stats Grid */
        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 1.5rem;
            margin-bottom: 2rem;
        }

        .stat-card {
            background: var(--bg-card);
            border-radius: 12px;
            padding: 1.5rem;
            border: 1px solid var(--border-color);
            transition: all 0.3s;
            position: relative;
            overflow: hidden;
        }

        .stat-card::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 4px;
            background: var(--primary);
            transform: translateX(-100%);
            transition: transform 0.3s;
        }

        .stat-card:hover::before {
            transform: translateX(0);
        }

        .stat-card:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.2);
        }

        .stat-header {
            display: flex;
            align-items: center;
            justify-content: space-between;
            margin-bottom: 1rem;
        }

        .stat-icon {
            width: 50px;
            height: 50px;
            background: var(--primary-transparent);
            border-radius: 10px;
            display: flex;
            align-items: center;
            justify-content: center;
            color: var(--primary);
            font-size: 1.5rem;
        }

        .stat-value {
            font-size: 2.25rem;
            font-weight: 700;
            color: var(--text-light);
        }

        .stat-label {
            color: var(--text-muted);
            font-size: 0.9rem;
            margin-top: 0.25rem;
        }

        .stat-change {
            font-size: 0.875rem;
            margin-top: 0.5rem;
            display: flex;
            align-items: center;
            gap: 0.25rem;
        }

        .stat-change.positive {
            color: var(--success);
        }

        .stat-change.negative {
            color: var(--danger);
        }

        /* Cards */
        .card {
            background: var(--bg-card);
            border-radius: 12px;
            border: 1px solid var(--border-color);
            margin-bottom: 1.5rem;
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
        }

        .card-header {
            padding: 1.5rem;
            border-bottom: 1px solid var(--border-color);
            display: flex;
            align-items: center;
            justify-content: space-between;
        }

        .card-title {
            font-size: 1.25rem;
            font-weight: 600;
            color: var(--text-light);
            margin: 0;
        }

        .card-body {
            padding: 1.5rem;
        }

        /* Course Grid */
        .course-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(320px, 1fr));
            gap: 1.5rem;
        }

        .course-card {
            background: var(--bg-card);
            border-radius: 12px;
            border: 1px solid var(--border-color);
            overflow: hidden;
            transition: all 0.3s;
            position: relative;
        }

        .course-card:hover {
            transform: translateY(-3px);
            box-shadow: 0 8px 25px rgba(0, 0, 0, 0.15);
        }

        .course-image {
            height: 150px;
            background: linear-gradient(135deg, var(--primary), var(--primary-dark));
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 3rem;
            color: var(--bg-dark);
        }

        .course-content {
            padding: 1.5rem;
        }

        .course-title {
            font-size: 1.1rem;
            font-weight: 600;
            margin-bottom: 0.5rem;
            color: var(--text-light);
        }

        .course-meta {
            color: var(--text-muted);
            font-size: 0.875rem;
            margin-bottom: 1rem;
        }

        .course-actions {
            display: flex;
            gap: 0.5rem;
            flex-wrap: wrap;
        }

        /* Buttons */
        .btn {
            padding: 0.5rem 1rem;
            border-radius: 6px;
            border: none;
            font-weight: 500;
            cursor: pointer;
            transition: all 0.3s;
            text-decoration: none;
            display: inline-flex;
            align-items: center;
            gap: 0.5rem;
            font-size: 0.875rem;
        }

        .btn-primary {
            background: var(--primary);
            color: var(--bg-dark);
        }

        .btn-primary:hover {
            background: var(--primary-dark);
            transform: translateY(-1px);
        }

        .btn-outline {
            border: 1px solid var(--primary);
            color: var(--primary);
            background: transparent;
        }

        .btn-outline:hover {
            background: var(--primary);
            color: var(--bg-dark);
        }

        .btn-success {
            background: var(--success);
            color: white;
        }

        .btn-warning {
            background: var(--warning);
            color: white;
        }

        .btn-danger {
            background: var(--danger);
            color: white;
        }

        .btn-info {
            background: var(--info);
            color: white;
        }

        .btn-sm {
            padding: 0.25rem 0.5rem;
            font-size: 0.8rem;
        }

        /* Form Styles */
        .form-control,
        .form-select {
            background: var(--bg-darker);
            border: 1px solid var(--border-color);
            color: var(--text-light);
            padding: 0.75rem;
            border-radius: 8px;
            width: 100%;
            transition: all 0.3s;
        }

        .form-control:focus,
        .form-select:focus {
            outline: none;
            border-color: var(--primary);
            box-shadow: 0 0 0 0.25rem var(--primary-transparent);
        }

        .form-label {
            color: var(--text-light);
            font-weight: 500;
            margin-bottom: 0.5rem;
            display: block;
        }

        .form-check-input {
            background-color: var(--bg-darker);
            border-color: var(--border-color);
        }

        .form-check-input:checked {
            background-color: var(--primary);
            border-color: var(--primary);
        }

        /* Quiz Generator */
        .quiz-generator {
            background: var(--bg-card);
            border-radius: 12px;
            border: 1px solid var(--border-color);
            padding: 2rem;
        }

        .form-row {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 1rem;
            margin-bottom: 1rem;
        }

        /* Table Styles */
        .table {
            width: 100%;
            background: var(--bg-card);
            border-radius: 8px;
            overflow: hidden;
            color: var(--text-light);
        }

        .table th {
            background: var(--bg-darker);
            color: var(--text-light);
            border-bottom: 1px solid var(--border-color);
            padding: 1rem;
            font-weight: 600;
            text-align: left;
        }

        .table td {
            color: var(--text-light);
            border-bottom: 1px solid var(--border-color);
            padding: 1rem;
            vertical-align: middle;
        }

        .table tbody tr:hover {
            background: var(--primary-transparent);
        }

        /* Progress Bar */
        .progress {
            height: 6px;
            background: var(--border-color);
            border-radius: 3px;
            overflow: hidden;
            margin-top: 0.5rem;
        }

        .progress-bar {
            background: var(--primary);
            height: 100%;
            transition: width 0.3s;
        }

        /* Badges */
        .badge {
            padding: 0.375rem 0.75rem;
            font-size: 0.75rem;
            border-radius: 6px;
            font-weight: 500;
            display: inline-block;
        }

        .badge-success {
            background: var(--success);
            color: white;
        }

        .badge-warning {
            background: var(--warning);
            color: white;
        }

        .badge-danger {
            background: var(--danger);
            color: white;
        }

        .badge-info {
            background: var(--info);
            color: white;
        }

        .badge-primary {
            background: var(--primary);
            color: var(--bg-dark);
        }

        /* Question Items */
        .question-item {
            background: var(--bg-darker);
            border: 1px solid var(--border-color);
            border-radius: 8px;
            padding: 1rem;
            margin-bottom: 1rem;
        }

        .question-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 0.5rem;
        }

        .question-text {
            font-weight: 500;
            color: var(--text-light);
        }

        .question-type {
            font-size: 0.75rem;
            padding: 0.25rem 0.5rem;
            border-radius: 4px;
            background: var(--primary-transparent);
            color: var(--primary);
        }

        .answer-options {
            margin-top: 0.5rem;
            padding-left: 1rem;
        }

        .answer-option {
            color: var(--text-muted);
            margin-bottom: 0.25rem;
        }

        .answer-option.correct {
            color: var(--success);
            font-weight: 500;
        }

        /* Loading Spinner */
        .loading {
            display: inline-block;
            width: 20px;
            height: 20px;
            border: 3px solid var(--border-color);
            border-radius: 50%;
            border-top-color: var(--primary);
            animation: spin 1s ease-in-out infinite;
        }

        @keyframes spin {
            to {
                transform: rotate(360deg);
            }
        }

        /* Mobile Styles */
        .mobile-menu-toggle {
            display: none;
            background: none;
            border: none;
            color: var(--text-light);
            font-size: 1.25rem;
            cursor: pointer;
        }

        @media (max-width: 768px) {
            .sidebar {
                transform: translateX(-100%);
            }

            .sidebar.mobile-open {
                transform: translateX(0);
            }

            .main-content {
                margin-left: 0;
            }

            .mobile-menu-toggle {
                display: block;
            }

            .stats-grid {
                grid-template-columns: 1fr;
            }

            .course-grid {
                grid-template-columns: 1fr;
            }

            .form-row {
                grid-template-columns: 1fr;
            }

            .header-left h1 {
                font-size: 1.25rem;
            }
        }

        /* Modal */
        .modal-content {
            background: var(--bg-card);
            border: 1px solid var(--border-color);
            color: var(--text-light);
        }

        .modal-header {
            border-bottom: 1px solid var(--border-color);
        }

        .modal-footer {
            border-top: 1px solid var(--border-color);
        }

        .btn-close {
            filter: invert(1);
        }

        [data-theme="light"] .btn-close {
            filter: none;
        }

        /* Alert */
        .alert {
            padding: 1rem 1.25rem;
            border-radius: 8px;
            margin-bottom: 1rem;
        }

        .alert-success {
            background: rgba(16, 185, 129, 0.1);
            color: var(--success);
            border: 1px solid rgba(16, 185, 129, 0.2);
        }

        .alert-info {
            background: rgba(59, 130, 246, 0.1);
            color: var(--info);
            border: 1px solid rgba(59, 130, 246, 0.2);
        }

        .alert-warning {
            background: rgba(245, 158, 11, 0.1);
            color: var(--warning);
            border: 1px solid rgba(245, 158, 11, 0.2);
        }

        .alert-danger {
            background: rgba(239, 68, 68, 0.1);
            color: var(--danger);
            border: 1px solid rgba(239, 68, 68, 0.2);
        }

        /* Chart Container */
        .chart-container {
            position: relative;
            height: 300px;
            width: 100%;
        }

        /* Message Styles */
        .message {
            padding: 0.75rem 1rem;
            border-radius: 12px;
            max-width: 80%;
            margin-bottom: 1rem;
        }

        .message.sent {
            align-self: flex-end;
            background: var(--primary);
            color: var(--bg-dark);
            margin-left: auto;
        }

        .message.received {
            align-self: flex-start;
            background: var(--border-color);
            color: var(--text-light);
        }

        /* Utility Classes */
        .text-muted {
            color: var(--text-muted) !important;
        }

        .text-success {
            color: var(--success) !important;
        }

        .text-danger {
            color: var(--danger) !important;
        }

        .text-warning {
            color: var(--warning) !important;
        }

        .text-info {
            color: var(--info) !important;
        }

        .fw-bold {
            font-weight: 700 !important;
        }

        .fw-semibold {
            font-weight: 600 !important;
        }

        .mb-0 {
            margin-bottom: 0 !important;
        }

        .mb-1 {
            margin-bottom: 0.25rem !important;
        }

        .mb-2 {
            margin-bottom: 0.5rem !important;
        }

        .mb-3 {
            margin-bottom: 1rem !important;
        }

        .mb-4 {
            margin-bottom: 1.5rem !important;
        }

        .mt-1 {
            margin-top: 0.25rem !important;
        }

        .mt-2 {
            margin-top: 0.5rem !important;
        }

        .mt-3 {
            margin-top: 1rem !important;
        }

        .mt-4 {
            margin-top: 1.5rem !important;
        }

        .me-1 {
            margin-right: 0.25rem !important;
        }

        .me-2 {
            margin-right: 0.5rem !important;
        }

        .gap-1 {
            gap: 0.25rem !important;
        }

        .gap-2 {
            gap: 0.5rem !important;
        }

        .gap-3 {
            gap: 1rem !important;
        }

        .d-flex {
            display: flex !important;
        }

        .d-block {
            display: block !important;
        }

        .d-none {
            display: none !important;
        }

        .align-items-center {
            align-items: center !important;
        }

        .justify-content-between {
            justify-content: space-between !important;
        }

        .justify-content-center {
            justify-content: center !important;
        }

        .flex-column {
            flex-direction: column !important;
        }

        .flex-wrap {
            flex-wrap: wrap !important;
        }

        .flex-grow-1 {
            flex-grow: 1 !important;
        }

        .text-center {
            text-align: center !important;
        }

        .w-100 {
            width: 100% !important;
        }

        .position-relative {
            position: relative !important;
        }

        .position-fixed {
            position: fixed !important;
        }
    </style>
</head>

<body>
    <!-- Sidebar -->
    <div class="sidebar" id="sidebar">
        <div class="sidebar-header">
            <a href="{% url 'home' %}" class="logo">
                <i class="fas fa-graduation-cap"></i>
                <span> Kalanso</span>
            </a>
        </div>

        <nav class="sidebar-menu">
            <button class="menu-item active" data-section="dashboard">
                <i class="fas fa-home"></i>
                <span>Tableau de bord</span>
            </button>
            <button class="menu-item" data-section="courses">
                <i class="fas fa-book"></i>
                <span>Modules</span>
            </button>
            <button class="menu-item" data-section="quiz-generator">
                <i class="fas fa-magic"></i>
                <span>Générateur Quiz IA</span>
            </button>
            <button class="menu-item" data-section="quiz-list">
                <i class="fas fa-list-check"></i>
                <span>Liste des Quiz</span>
            </button>
            <button class="menu-item" data-section="students">
                <i class="fas fa-users"></i>
                <span>Mes Étudiants</span>
            </button>
            <button class="menu-item" data-section="statistics">
                <i class="fas fa-chart-bar"></i>
                <span>Statistiques</span>
            </button>
            <button class="menu-item" data-section="messages">
                <i class="fas fa-envelope"></i>
                <span>Messages</span>
            </button>
            <button class="menu-item" data-section="settings">
                <i class="fas fa-cog"></i>
                <span>Paramètres</span>
            </button>
        </nav>

        <div class="user-profile">
            <div class="user-info">
                <div class="user-avatar">JD</div>
                <div class="user-details">
                    <div class="user-name">Jean Dupont</div>
                    <div class="user-role">Professeur</div>
                </div>
            </div>
            <a href="{% url 'home' %}" class="btn btn-outline w-100 mb-3">
                <i class="fas fa-sign-out-alt"></i>
                <span>Accueil</span>
            </a>
            <a href="{% url 'logout' %}" class="btn btn-outline w-100">
                <i class="fas fa-sign-out-alt"></i>
                <span>Déconnexion</span>
            </a>
        </div>
    </div>



    <!-- Modal de Remplacement de Fichier Cours -->
    <div class="modal fade" id="replaceCourseFileModal" tabindex="-1">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title">Remplacer le Fichier du Cours</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
                </div>
                <div class="modal-body">
                    <div class="file-upload-area" onclick="document.getElementById('courseFileInput').click()">
                        <i class="fas fa-cloud-upload-alt fa-3x text-muted mb-3"></i>
                        <h5>Glissez-déposez votre nouveau fichier ici</h5>
                        <p class="text-muted">ou cliquez pour parcourir</p>
                        <small class="text-muted">Formats acceptés: PDF, DOC, DOCX, PPT, PPTX (Max:
                            50MB)</small>
                        <input type="file" id="courseFileInput" style="display: none;"
                            accept=".pdf,.doc,.docx,.ppt,.pptx">
                    </div>
                    <div id="newFileInfo" class="mt-3" style="display: none;">
                        <div class="alert alert-info">
                            <i class="fas fa-file"></i>
                            <span id="newFileName"></span>
                            <button type="button" class="btn btn-sm btn-outline-danger float-end"
                                onclick="clearNewFile()">
                                <i class="fas fa-times"></i>
                            </button>
                        </div>
                    </div>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-outline-secondary" data-bs-dismiss="modal">Annuler</button>
                    <button type="button" class="btn btn-primary" onclick="replaceCourseFile()" id="replaceFileBtn"
                        disabled>
                        <i class="fas fa-upload"></i>
                        Remplacer
                    </button>
                </div>
            </div>
        </div>
    </div>

    <!-- Main Content -->
    <div class="main-content">
        <!-- Header -->
        <header class="header">
            <div class="header-left">
                <button class="mobile-menu-toggle" id="mobileMenuToggle">
                    <i class="fas fa-bars"></i>
                </button>
                <h1 id="pageTitle">Tableau de bord</h1>
            </div>
            <div class="header-right">
                <button class="notifications">
                    <i class="fas fa-bell"></i>
                    <span class="notification-badge">3</span>
                </button>
                <button class="theme-toggle" id="themeToggle">
                    <i class="fas fa-moon" id="themeIcon"></i>
                </button>
            </div>
        </header>
































        <!-- Dashboard Section -->
        <div class="content-section active" id="dashboard">
            <div class="stats-grid">
                <div class="stat-card">
                    <div class="stat-header">
                        <div class="stat-icon">
                            <i class="fas fa-book"></i>
                        </div>
                        <div class="stat-value">12</div>
                    </div>
                    <div class="stat-label">Cours créés</div>
                    <div class="stat-change positive">
                        <i class="fas fa-arrow-up"></i>
                        <span>+3 ce mois</span>
                    </div>
                </div>

                <div class="stat-card">
                    <div class="stat-header">
                        <div class="stat-icon">
                            <i class="fas fa-users"></i>
                        </div>
                        <div class="stat-value">234</div>
                    </div>
                    <div class="stat-label">Étudiants inscrits</div>
                    <div class="stat-change positive">
                        <i class="fas fa-arrow-up"></i>
                        <span>+18 cette semaine</span>
                    </div>
                </div>

                <div class="stat-card">
                    <div class="stat-header">
                        <div class="stat-icon">
                            <i class="fas fa-question-circle"></i>
                        </div>
                        <div class="stat-value">45</div>
                    </div>
                    <div class="stat-label">Quiz générés</div>
                    <div class="stat-change positive">
                        <i class="fas fa-arrow-up"></i>
                        <span>+8 cette semaine</span>
                    </div>
                </div>

                <div class="stat-card">
                    <div class="stat-header">
                        <div class="stat-icon">
                            <i class="fas fa-chart-line"></i>
                        </div>
                        <div class="stat-value">92%</div>
                    </div>
                    <div class="stat-label">Taux de réussite moyen</div>
                    <div class="stat-change positive">
                        <i class="fas fa-arrow-up"></i>
                        <span>+5% ce mois</span>
                    </div>
                </div>
            </div>

            <!-- Activité récente -->
            <div class="row mt-4">
                <div class="col-lg-8">
                    <div class="card">
                        <div class="card-header">
                            <h3 class="card-title">Activité récente</h3>
                            <button class="btn btn-sm btn-outline">Voir tout</button>
                        </div>
                        <div class="card-body">
                            <div class="activity-list">
                                <div class="activity-item d-flex align-items-center gap-3 mb-3">
                                    <div class="stat-icon">
                                        <i class="fas fa-magic"></i>
                                    </div>
                                    <div class="flex-grow-1">
                                        <div class="fw-semibold">Quiz "Algorithmes avancés" généré</div>
                                        <small class="text-muted">Il y a 2 heures • 15 questions • Niveau
                                            Intermédiaire</small>
                                    </div>
                                    <span class="badge badge-success">Nouveau</span>
                                </div>
                                <div class="activity-item d-flex align-items-center gap-3 mb-3">
                                    <div class="stat-icon">
                                        <i class="fas fa-user-plus"></i>
                                    </div>
                                    <div class="flex-grow-1">
                                        <div class="fw-semibold">3 nouveaux étudiants inscrits</div>
                                        <small class="text-muted">Il y a 4 heures • Cours "Base de données"</small>
                                    </div>
                                    <span class="badge badge-info">Inscription</span>
                                </div>
                                <div class="activity-item d-flex align-items-center gap-3">
                                    <div class="stat-icon">
                                        <i class="fas fa-trophy"></i>
                                    </div>
                                    <div class="flex-grow-1">
                                        <div class="fw-semibold">Marie Dubois a obtenu 18/20 au quiz</div>
                                        <small class="text-muted">Il y a 6 heures • Quiz "Introduction SQL"</small>
                                    </div>
                                    <span class="badge badge-primary">Résultat</span>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="col-lg-4">
                    <div class="card">
                        <div class="card-header">
                            <h3 class="card-title">Actions rapides</h3>
                        </div>
                        <div class="card-body">
                            <div class="d-flex flex-column gap-2">
                                <button class="btn btn-primary" onclick="showSection('courses')">
                                    <i class="fas fa-plus"></i>
                                    Créer un cours
                                </button>
                                <button class="btn btn-success" onclick="showSection('quiz-generator')">
                                    <i class="fas fa-magic"></i>
                                    Générer un quiz
                                </button>
                                <button class="btn btn-info" onclick="showSection('students')">
                                    <i class="fas fa-users"></i>
                                    Voir les étudiants
                                </button>
                                <button class="btn btn-warning" onclick="showSection('statistics')">
                                    <i class="fas fa-chart-bar"></i>
                                    Statistiques
                                </button>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Module Section -->
        <div class="content-section" id="courses">
            <div class="d-flex justify-content-between align-items-center mb-4">
                <h2>Mes Modules</h2>
                <button class="btn btn-primary" onclick="openCreateCourseModal()">
                    <i class="fas fa-plus"></i>
                    Ajouter un nouveau module
                </button>
            </div>


            <div class="course-grid" id="module-list">
                {% for module in modules %}
                <div class="course-card">
                    <div class="course-image">
                        <i class="fas fa-book"></i> <!-- Icône générique pour les cours -->
                    </div>
                    <div class="course-content">
                        <h4 class="course-title">{{ module.titre }}</h4>
                        <div class="course-meta">{{ module.nb_etudiants }} étudiants • {{ module.nb_quiz }} quiz • Code:
                            {{ module.code }}</div>
                        <div class="progress">
                            <div class="progress-bar" style="width: {{ module.progress }}%"></div>
                        </div>
                        <div class="course-actions mt-3">
                            <button class="btn btn-sm btn-primary">
                                <i class="fas fa-edit"></i>
                                Modifier
                            </button>
                            <button class="btn btn-sm btn-success" onclick="showSection('quiz-generator')">
                                <i class="fas fa-magic"></i>
                                Quiz IA
                            </button>
                            <button class="btn btn-sm btn-info"
                                onclick="showModuleDetails('{{ module.titre }}', '{{ module.code }}')">
                                <i class="fas fa-eye"></i>
                                Détails
                            </button>
                        </div>
                    </div>
                </div>
                {% empty %}
                <p>Aucun module disponible.</p>
                {% endfor %}
            </div>















            <!-- Section Détails du Cours avec Modification -->
            <!-- <div id="course-details-section" class="content-section" style="display: block;">
                <div class="card">
                    <div class="card-header">
                        <div class="d-flex justify-content-between align-items-center">
                            <div>
                                <h4 id="course-title">Nom du Cours</h4>
                                <span class="badge badge-info">Cours</span>
                            </div>
                            <div class="btn-group">
                                <button class="btn btn-outline-secondary" onclick="goBackToCourseList()">
                                    <i class="fas fa-arrow-left"></i>
                                    Retour
                                </button>
                                <button class="btn btn-primary" id="edit-course-btn" onclick="toggleCourseEditMode()">
                                    <i class="fas fa-edit"></i>
                                    Modifier
                                </button>
                            </div>
                        </div>
                    </div>
                    <div class="card-body">
                  
                        <div id="course-view-mode">
                            <div class="row">
                               
                                <div class="col-md-4">
                                    <div class="course-info-panel">
                                        <h5>Informations du Cours</h5>
                                        <div class="info-item">
                                            <strong>Titre :</strong>
                                            <span id="display-course-title">Introduction aux Algorithmes</span>
                                        </div>
                                        <div class="info-item">
                                            <strong>Description :</strong>
                                            <span id="display-course-description">Ce cours couvre les concepts
                                                fondamentaux des algorithmes...</span>
                                        </div>
                                        <div class="info-item">
                                            <strong>Fichier :</strong>
                                            <span id="display-file-name">intro_algo.pdf</span>
                                        </div>
                                        <div class="info-item">
                                            <strong>Taille :</strong>
                                            <span id="display-file-size">2.5 MB</span>
                                        </div>
                                        <div class="info-item">
                                            <strong>Dernière modification :</strong>
                                            <span id="display-last-modified">15 Jan 2024</span>
                                        </div>

                                       
                                        <div class="file-actions mt-3">
                                            <button class="btn btn-success btn-sm" onclick="downloadCourseFile()">
                                                <i class="fas fa-download"></i>
                                                Télécharger
                                            </button>
                                            <button class="btn btn-info btn-sm" onclick="openCourseInNewTab()">
                                                <i class="fas fa-external-link-alt"></i>
                                                Ouvrir
                                            </button>
                                            <button class="btn btn-warning btn-sm" data-bs-toggle="modal"
                                                data-bs-target="#replaceCourseFileModal">
                                                <i class="fas fa-upload"></i>
                                                Remplacer
                                            </button>
                                        </div>
                                    </div>
                                </div>

                                <div class="col-md-8">
                                    <div class="pdf-preview-container">
                                        <div class="pdf-toolbar">
                                            <div class="d-flex justify-content-between align-items-center">
                                                <h6 class="mb-0">Aperçu du Document</h6>
                                                <div class="pdf-controls">
                                                    <button class="btn btn-sm btn-outline-secondary"
                                                        onclick="zoomOut()">
                                                        <i class="fas fa-search-minus"></i>
                                                    </button>
                                                    <span class="zoom-level">100%</span>
                                                    <button class="btn btn-sm btn-outline-secondary" onclick="zoomIn()">
                                                        <i class="fas fa-search-plus"></i>
                                                    </button>
                                                    <button class="btn btn-sm btn-outline-secondary"
                                                        onclick="toggleFullscreen()">
                                                        <i class="fas fa-expand"></i>
                                                    </button>
                                                </div>
                                            </div>
                                        </div>
                                        <div class="pdf-viewer-wrapper">
                                            <iframe id="course-pdf-viewer" src="" class="course-pdf-display"
                                                frameborder="0">
                                                <div class="pdf-fallback">
                                                    <i class="fas fa-file-pdf fa-3x text-muted mb-3"></i>
                                                    <p>Impossible d'afficher le PDF dans le navigateur</p>
                                                    <button class="btn btn-primary" onclick="downloadCourseFile()">
                                                        <i class="fas fa-download"></i>
                                                        Télécharger le fichier
                                                    </button>
                                                </div>
                                            </iframe>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>

                       
                        <div id="course-edit-mode" style="display: none;">
                            <form id="course-edit-form">
                                <div class="row">
                                    <div class="col-md-6">
                                        <div class="mb-3">
                                            <label class="form-label">Titre du Cours</label>
                                            <input type="text" class="form-control" id="edit-course-title" required>
                                        </div>
                                    </div>
                                    <div class="col-md-6">
                                        <div class="mb-3">
                                            <label class="form-label">Code du Cours</label>
                                            <input type="text" class="form-control" id="edit-course-code" required>
                                        </div>
                                    </div>
                                </div>
                                <div class="mb-3">
                                    <label class="form-label">Description</label>
                                    <textarea class="form-control" id="edit-course-description" rows="4"></textarea>
                                </div>
                                <div class="mb-3">
                                    <label class="form-label">Fichier du Cours</label>
                                    <div class="current-file-info">
                                        <div class="alert alert-info">
                                            <i class="fas fa-file-pdf me-2"></i>
                                            <span id="current-file-display">intro_algo.pdf</span>
                                            <button type="button" class="btn btn-sm btn-outline-primary ms-2"
                                                data-bs-toggle="modal" data-bs-target="#replaceCourseFileModal">
                                                Changer le fichier
                                            </button>
                                        </div>
                                    </div>
                                </div>
                                <div class="edit-actions">
                                    <button type="button" class="btn btn-outline-secondary"
                                        onclick="cancelCourseEdit()">
                                        Annuler
                                    </button>
                                    <button type="submit" class="btn btn-primary">
                                        <i class="fas fa-save"></i>
                                        Sauvegarder
                                    </button>
                                </div>
                            </form>
                        </div>
                    </div>
                </div>
            </div> -->



            <!-- Section Détails des Exercices (Générés par IA)
            <div id="exercise-details-section" class="content-section" style="display: block;">
                <div class="card">
                    <div class="card-header">
                        <div class="d-flex justify-content-between align-items-center">
                            <div>
                                <h4 id="exercise-title">Exercices Pratiques</h4>
                                <span class="badge badge-warning">Exercices</span>
                                <span class="badge badge-success ms-2">
                                    <i class="fas fa-robot me-1"></i>
                                    Généré par IA
                                </span>
                            </div>
                            <div class="btn-group">
                                <button class="btn btn-outline-secondary" onclick="goBackToExerciseList()">
                                    <i class="fas fa-arrow-left"></i>
                                    Retour
                                </button>
                                <button class="btn btn-success" onclick="regenerateExercises()">
                                    <i class="fas fa-sync-alt"></i>
                                    Régénérer
                                </button>
                                <button class="btn btn-primary" onclick="addCustomExercise()">
                                    <i class="fas fa-plus"></i>
                                    Ajouter
                                </button>
                            </div>
                        </div>
                    </div>
                    <div class="card-body">
                       
                        <div class="generation-info mb-4">
                            <div class="row">
                                <div class="col-md-3">
                                    <div class="stat-item">
                                        <span class="stat-label">Difficulté</span>
                                        <span class="stat-value" id="exercise-difficulty">Intermédiaire</span>
                                    </div>
                                </div>
                                <div class="col-md-3">
                                    <div class="stat-item">
                                        <span class="stat-label">Nombre d'exercices</span>
                                        <span class="stat-value" id="exercise-count">8</span>
                                    </div>
                                </div>
                                <div class="col-md-3">
                                    <div class="stat-item">
                                        <span class="stat-label">Basé sur</span>
                                        <span class="stat-value" id="exercise-source">Cours PDF</span>
                                    </div>
                                </div>
                                <div class="col-md-3">
                                    <div class="stat-item">
                                        <span class="stat-label">Généré le</span>
                                        <span class="stat-value" id="exercise-generated-date">20 Jan 2024</span>
                                    </div>
                                </div>
                            </div>
                        </div>

                       
                        <div class="regeneration-panel mb-4" style="display: none;" id="regeneration-options">
                            <div class="card">
                                <div class="card-body">
                                    <h6>Options de Régénération</h6>
                                    <div class="row">
                                        <div class="col-md-4">
                                            <label class="form-label">Difficulté</label>
                                            <select class="form-select" id="regen-difficulty">
                                                <option value="facile">Facile</option>
                                                <option value="intermediaire" selected>Intermédiaire</option>
                                                <option value="difficile">Difficile</option>
                                            </select>
                                        </div>
                                        <div class="col-md-4">
                                            <label class="form-label">Nombre d'exercices</label>
                                            <input type="number" class="form-control" id="regen-count" value="8" min="1"
                                                max="20">
                                        </div>
                                        <div class="col-md-4">
                                            <label class="form-label">Focus sur</label>
                                            <select class="form-select" id="regen-focus">
                                                <option value="general">Général</option>
                                                <option value="pratique">Pratique</option>
                                                <option value="theorie">Théorie</option>
                                                <option value="application">Application</option>
                                            </select>
                                        </div>
                                    </div>
                                    <div class="mt-3">
                                        <button class="btn btn-outline-secondary btn-sm"
                                            onclick="hideRegenerationOptions()">Annuler</button>
                                        <button class="btn btn-success btn-sm" onclick="confirmRegeneration()">
                                            <i class="fas fa-magic"></i>
                                            Générer
                                        </button>
                                    </div>
                                </div>
                            </div>
                        </div>

                      
                        <div class="exercises-list" id="exercises-container">
                           
                        </div>
                    </div>
                </div>
            </div> -->



            <!-- Section Détails du Quiz (Généré par IA) -->
            <!-- <div id="quiz-details-section" class="content-section" style="display: block;">
                <div class="card">
                    <div class="card-header">
                        <div class="d-flex justify-content-between align-items-center">
                            <div>
                                <h4 id="quiz-title">Quiz Chapitre 1</h4>
                                <span class="badge badge-success">Quiz</span>
                                <span class="badge badge-info ms-2">
                                    <i class="fas fa-robot me-1"></i>
                                    Généré par IA
                                </span>
                            </div>
                            <div class="btn-group">
                                <button class="btn btn-outline-secondary" onclick="goBackToQuizList()">
                                    <i class="fas fa-arrow-left"></i>
                                    Retour
                                </button>
                                <button class="btn btn-warning" onclick="previewQuiz()">
                                    <i class="fas fa-eye"></i>
                                    Aperçu
                                </button>
                                <button class="btn btn-success" onclick="regenerateQuiz()">
                                    <i class="fas fa-sync-alt"></i>
                                    Régénérer
                                </button>
                                <button class="btn btn-primary" onclick="publishQuiz()">
                                    <i class="fas fa-paper-plane"></i>
                                    Publier
                                </button>
                            </div>
                        </div>
                    </div>
                    <div class="card-body">
                 
                        <div class="quiz-config mb-4">
                            <div class="row">
                                <div class="col-md-2">
                                    <div class="stat-item">
                                        <span class="stat-label">Questions</span>
                                        <span class="stat-value" id="quiz-question-count">10</span>
                                    </div>
                                </div>
                                <div class="col-md-2">
                                    <div class="stat-item">
                                        <span class="stat-label">Durée</span>
                                        <span class="stat-value" id="quiz-duration">15 min</span>
                                    </div>
                                </div>
                                <div class="col-md-2">
                                    <div class="stat-item">
                                        <span class="stat-label">Points total</span>
                                        <span class="stat-value" id="quiz-total-points">50</span>
                                    </div>
                                </div>
                                <div class="col-md-3">
                                    <div class="stat-item">
                                        <span class="stat-label">Difficulté</span>
                                        <span class="stat-value" id="quiz-difficulty">Intermédiaire</span>
                                    </div>
                                </div>
                                <div class="col-md-3">
                                    <div class="stat-item">
                                        <span class="stat-label">Statut</span>
                                        <span class="badge badge-warning" id="quiz-status">Brouillon</span>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <div class="quiz-settings mb-4">
                            <button class="btn btn-outline-primary btn-sm" onclick="toggleQuizSettings()">
                                <i class="fas fa-cog"></i>
                                Paramètres Avancés
                            </button>
                        </div>

                        <div class="quiz-advanced-settings" id="quiz-advanced-panel" style="display: none;">
                            <div class="card mb-4">
                                <div class="card-body">
                                    <div class="row">
                                        <div class="col-md-4">
                                            <label class="form-label">Tentatives autorisées</label>
                                            <select class="form-select">
                                                <option value="1" selected>1 tentative</option>
                                                <option value="2">2 tentatives</option>
                                                <option value="3">3 tentatives</option>
                                                <option value="unlimited">Illimitées</option>
                                            </select>
                                        </div>
                                        <div class="col-md-4">
                                            <label class="form-label">Mélanger les questions</label>
                                            <select class="form-select">
                                                <option value="yes" selected>Oui</option>
                                                <option value="no">Non</option>
                                            </select>
                                        </div>
                                        <div class="col-md-4">
                                            <label class="form-label">Afficher les résultats</label>
                                            <select class="form-select">
                                                <option value="immediately" selected>Immédiatement</option>
                                                <option value="after_due">Après la date limite</option>
                                                <option value="never">Jamais</option>
                                            </select>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>

                      
                        <div class="quiz-questions" id="quiz-questions-container">
                          
                        </div>
                    </div>
                </div>
            </div> -->



            <!-- Section Détails de l'Évaluation (Générée par IA) -->
            <!-- <div id="evaluation-details-section" class="content-section" style="display: block;">
                <div class="card">
                    <div class="card-header">
                        <div class="d-flex justify-content-between align-items-center">
                            <div>
                                <h4 id="evaluation-title">Évaluation Finale</h4>
                                <span class="badge badge-danger">Évaluation</span>
                                <span class="badge badge-info ms-2">
                                    <i class="fas fa-robot me-1"></i>
                                    Généré par IA
                                </span>
                            </div>
                            <div class="btn-group">
                                <button class="btn btn-outline-secondary" onclick="goBackToEvaluationList()">
                                    <i class="fas fa-arrow-left"></i>
                                    Retour
                                </button>
                                <button class="btn btn-info" onclick="previewEvaluation()">
                                    <i class="fas fa-eye"></i>
                                    Aperçu
                                </button>
                                <button class="btn btn-success" onclick="regenerateEvaluation()">
                                    <i class="fas fa-sync-alt"></i>
                                    Régénérer
                                </button>
                                <button class="btn btn-warning" onclick="launchEvaluation()">
                                    <i class="fa-solid fa-comment-dots"></i>
                                    Feedback
                                </button>
                            </div>
                        </div>
                    </div>
                    <div class="card-body">
                   
                        <div class="evaluation-control-panel mb-4">
                            <div class="row">
                                <div class="col-md-2">
                                    <div class="stat-item">
                                        <span class="stat-label">Questions</span>
                                        <span class="stat-value" id="eval-question-count">15</span>
                                    </div>
                                </div>
                                <div class="col-md-2">
                                    <div class="stat-item">
                                        <span class="stat-label">Durée</span>
                                        <span class="stat-value" id="eval-duration">90 min</span>
                                    </div>
                                </div>
                                <div class="col-md-2">
                                    <div class="stat-item">
                                        <span class="stat-label">Points total</span>
                                        <span class="stat-value" id="eval-total-points">100</span>
                                    </div>
                                </div>
                                <div class="col-md-3">
                                    <div class="stat-item">
                                        <span class="stat-label">Date limite</span>
                                        <span class="stat-value" id="eval-due-date">Non définie</span>
                                    </div>
                                </div>
                                <div class="col-md-3">
                                    <div class="stat-item">
                                        <span class="stat-label">Statut</span>
                                        <span class="badge badge-secondary" id="eval-status">Préparation</span>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <div class="evaluation-config mb-4">
                            <button class="btn btn-outline-primary btn-sm" onclick="toggleEvaluationSettings()">
                                <i class="fas fa-cog"></i>
                                Configuration de l'Évaluation
                            </button>
                        </div>

                        <div class="evaluation-settings-panel" id="evaluation-settings-panel" style="display: none;">
                            <div class="card mb-4">
                                <div class="card-body">
                                    <div class="row">
                                        <div class="col-md-6">
                                            <label class="form-label">Date et heure de début</label>
                                            <input type="datetime-local" class="form-control" id="eval-start-date">
                                        </div>
                                        <div class="col-md-6">
                                            <label class="form-label">Date et heure de fin</label>
                                            <input type="datetime-local" class="form-control" id="eval-end-date">
                                        </div>
                                    </div>
                                    <div class="row mt-3">
                                        <div class="col-md-4">
                                            <label class="form-label">Note de passage (%)</label>
                                            <input type="number" class="form-control" value="60" min="0" max="100">
                                        </div>
                                        <div class="col-md-4">
                                            <label class="form-label">Tentatives</label>
                                            <select class="form-select">
                                                <option value="1" selected>1 seule tentative</option>
                                                <option value="2">2 tentatives</option>
                                            </select>
                                        </div>
                                        <div class="col-md-4">
                                            <label class="form-label">Surveillance</label>
                                            <select class="form-select">
                                                <option value="none">Aucune</option>
                                                <option value="basic" selected>Basique</option>
                                                <option value="advanced">Avancée</option>
                                            </select>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <div class="evaluation-questions" id="evaluation-questions-container">
                         
                        </div>

                     
                        <div class="launch-controls mt-4" style="display: none;" id="launch-controls">
                            <div class="alert alert-warning">
                                <i class="fas fa-exclamation-triangle me-2"></i>
                                <strong>Attention :</strong> Une fois lancée, l'évaluation sera accessible aux étudiants
                                selon la planification définie.
                            </div>
                            <div class="d-flex gap-2">
                                <button class="btn btn-outline-secondary"
                                    onclick="hideLaunchControls()">Annuler</button>
                                <button class="btn btn-warning" onclick="confirmLaunchEvaluation()">
                                    <i class="fas fa-rocket"></i>
                                    Confirmer le Lancement
                                </button>
                            </div>
                        </div>
                    </div>
                </div>
            </div> -->




        </div>



        <!-- Module Detail Section -->
        <section class="" style="padding: 5%;">
            <div class="card text-center" id="module-details" style="display: none;">
                <div class="card-header">
                    <div class="d-flex justify-content-between align-items-center flex-wrap gap-3">
                        <h3 class="card-title mb-0" id="module-title">Détails du Module</h3>

                        <!-- Search and Filter Section -->
                        <div class="d-flex align-items-center gap-3 flex-grow-1 justify-content-center">
                            <!-- Search Form -->
                            <div class="search-container position-relative">
                                <i class="fas fa-search position-absolute"
                                    style="left: 15px; top: 50%; transform: translateY(-50%); color: var(--text-muted); z-index: 1;"></i>
                                <input type="search" id="contentSearch" class="form-control ps-5 pe-4"
                                    placeholder="Rechercher du contenu..." style="min-width: 250px;"
                                    autocomplete="off" />
                                <button type="button" id="clearSearch" class="btn btn-link position-absolute p-0"
                                    style="right: 10px; top: 50%; transform: translateY(-50%); display: none;"
                                    title="Effacer la recherche">
                                    <i class="fas fa-times text-muted"></i>
                                </button>
                            </div>

                            <!-- Filter Dropdown -->
                            <div class="dropdown">
                                <button class="btn btn-outline-primary dropdown-toggle d-flex align-items-center gap-2"
                                    type="button" id="filterDropdown" data-bs-toggle="dropdown" aria-expanded="false">
                                    <i class="fas fa-filter"></i>
                                    <span id="filterText">Tous les types</span>
                                    <span class="badge badge-primary" id="filterCount" style="display: none;">0</span>
                                </button>
                                <ul class="dropdown-menu" aria-labelledby="filterDropdown">
                                    <li>
                                        <button class="dropdown-item filter-option active" type="button"
                                            data-filter="all">
                                            <i class="fas fa-list me-2"></i>
                                            Tous les types
                                            <span class="badge badge-secondary ms-auto" id="count-all">4</span>
                                        </button>
                                    </li>
                                    <li>
                                        <hr class="dropdown-divider">
                                    </li>
                                    <li>
                                        <button class="dropdown-item filter-option" type="button" data-filter="cours">
                                            <i class="fas fa-book me-2"></i>
                                            Cours
                                            <span class="badge badge-info ms-auto" id="count-cours">2</span>
                                        </button>
                                    </li>
                                    <li>
                                        <button class="dropdown-item filter-option" type="button"
                                            data-filter="exercice">
                                            <i class="fas fa-dumbbell me-2"></i>
                                            Exercices
                                            <span class="badge badge-warning ms-auto" id="count-exercice">1</span>
                                        </button>
                                    </li>
                                    <li>
                                        <button class="dropdown-item filter-option" type="button" data-filter="quiz">
                                            <i class="fas fa-question-circle me-2"></i>
                                            Quiz
                                            <span class="badge badge-success ms-auto" id="count-quiz">0</span>
                                        </button>
                                    </li>
                                    <li>
                                        <button class="dropdown-item filter-option" type="button"
                                            data-filter="evaluation">
                                            <i class="fas fa-star me-2"></i>
                                            Évaluations
                                            <span class="badge badge-danger ms-auto" id="count-evaluation">1</span>
                                        </button>
                                    </li>
                                </ul>
                            </div>

                            <!-- Sort Dropdown -->
                            <div class="dropdown">
                                <button class="btn btn-outline-secondary dropdown-toggle" type="button"
                                    id="sortDropdown" data-bs-toggle="dropdown" aria-expanded="false">
                                    <i class="fas fa-sort"></i>
                                </button>
                                <ul class="dropdown-menu" aria-labelledby="sortDropdown">
                                    <li>
                                        <button class="dropdown-item sort-option active" type="button"
                                            data-sort="name-asc">
                                            <i class="fas fa-sort-alpha-down me-2"></i>Nom (A-Z)
                                        </button>
                                    </li>
                                    <li>
                                        <button class="dropdown-item sort-option" type="button" data-sort="name-desc">
                                            <i class="fas fa-sort-alpha-up me-2"></i>Nom (Z-A)
                                        </button>
                                    </li>
                                    <li>
                                        <button class="dropdown-item sort-option" type="button" data-sort="date-desc">
                                            <i class="fas fa-sort-numeric-down me-2"></i>Plus récent
                                        </button>
                                    </li>
                                    <li>
                                        <button class="dropdown-item sort-option" type="button" data-sort="date-asc">
                                            <i class="fas fa-sort-numeric-up me-2"></i>Plus ancien
                                        </button>
                                    </li>
                                </ul>
                            </div>
                        </div>

                        <!-- Action Buttons -->
                        <div class="d-flex gap-2">
                            <button class="btn btn-primary" onclick="openCreateContentModal()"
                                title="Ajouter du contenu">
                                <i class="fas fa-plus"></i>
                                Ajouter
                            </button>
                            <button class="btn btn-secondary" onclick="backToModules()" title="Fermer">
                                <i class="fas fa-times"></i>
                            </button>
                        </div>
                    </div>

                    <!-- Search Results Info -->
                    <div class="mt-3" id="searchInfo" style="display: none;">
                        <div class="alert alert-info mb-0 py-2">
                            <i class="fas fa-info-circle me-2"></i>
                            <span id="searchResultText"></span>
                            <button type="button" class="btn btn-link btn-sm p-0 ms-2" onclick="clearAllFilters()">
                                Effacer les filtres
                            </button>
                        </div>
                    </div>
                </div>

                <div class="card-body">
                    <!-- Loading State -->
                    <div id="loadingState" style="display: none;">
                        <div class="d-flex justify-content-center align-items-center py-5">
                            <div class="spinner-border text-primary me-3" role="status"></div>
                            <span>Recherche en cours...</span>
                        </div>
                    </div>

                    <!-- No Results State -->
                    <div id="noResults" style="display: none;">
                        <div class="text-center py-5">
                            <i class="fas fa-search fa-3x text-muted mb-3"></i>
                            <h5 class="text-muted">Aucun résultat trouvé</h5>
                            <p class="text-muted">Essayez de modifier vos critères de recherche ou vos filtres.</p>
                            <button class="btn btn-outline-primary" onclick="clearAllFilters()">
                                <i class="fas fa-undo me-2"></i>Réinitialiser les filtres
                            </button>
                        </div>
                    </div>

                    <!-- Content Grid -->
                    <div class="" id="content-list">
                        <div class="course-grid" id="module-content-list">

                        </div>
                        <div class="card" id="content-card">

                        </div>
                    </div>

                </div>

                <div class="card-footer text-body-secondary d-flex justify-content-between align-items-center">
                    <span id="resultCount">4 éléments trouvés</span>
                    <div class="d-flex gap-2">
                        <button class="btn btn-outline-primary btn-sm" onclick="exportContent()">
                            <i class="fas fa-download me-1"></i>Exporter
                        </button>
                        <button class="btn btn-primary btn-sm" onclick="bulkActions()">
                            <i class="fas fa-cog me-1"></i>Actions groupées
                        </button>
                    </div>
                </div>
            </div>
        </section>

        <script>
            document.addEventListener('DOMContentLoaded', function () {
                const searchInput = document.getElementById('contentSearch');
                const clearSearchBtn = document.getElementById('clearSearch');
                const contentGrid = document.getElementById('module-content-list');
                const searchInfo = document.getElementById('searchInfo');
                const searchResultText = document.getElementById('searchResultText');
                const noResults = document.getElementById('noResults');
                const loadingState = document.getElementById('loadingState');
                const resultCount = document.getElementById('resultCount');

                let currentFilter = 'all';
                let currentSort = 'name-asc';
                let searchTimeout;

                // Search functionality
                searchInput.addEventListener('input', function () {
                    const query = this.value.trim();

                    // Show/hide clear button
                    clearSearchBtn.style.display = query ? 'block' : 'none';

                    // Debounce search
                    clearTimeout(searchTimeout);
                    searchTimeout = setTimeout(() => {
                        performSearch(query);
                    }, 300);
                });

                // Clear search
                clearSearchBtn.addEventListener('click', function () {
                    searchInput.value = '';
                    this.style.display = 'none';
                    performSearch('');
                });

                // Filter functionality
                document.querySelectorAll('.filter-option').forEach(option => {
                    option.addEventListener('click', function () {
                        // Update active state
                        document.querySelectorAll('.filter-option').forEach(opt => opt.classList.remove('active'));
                        this.classList.add('active');

                        currentFilter = this.getAttribute('data-filter');

                        // Update filter button text
                        const filterText = document.getElementById('filterText');
                        const filterIcon = this.querySelector('i').className;
                        const filterLabel = this.textContent.trim().split('\n')[0].trim();

                        filterText.innerHTML = `<i class="${filterIcon} me-2"></i>${filterLabel}`;

                        applyFilters();
                    });
                });

                // Sort functionality
                document.querySelectorAll('.sort-option').forEach(option => {
                    option.addEventListener('click', function () {
                        // Update active state
                        document.querySelectorAll('.sort-option').forEach(opt => opt.classList.remove('active'));
                        this.classList.add('active');

                        currentSort = this.getAttribute('data-sort');
                        applyFilters();
                    });
                });

                function performSearch(query) {
                    showLoading(true);

                    setTimeout(() => {
                        const cards = Array.from(contentGrid.querySelectorAll('.course-card'));
                        let visibleCount = 0;

                        cards.forEach(card => {
                            const title = card.getAttribute('data-title').toLowerCase();
                            const code = card.getAttribute('data-code').toLowerCase();
                            const type = card.getAttribute('data-type').toLowerCase();

                            const matchesSearch = !query ||
                                title.includes(query.toLowerCase()) ||
                                code.includes(query.toLowerCase()) ||
                                type.includes(query.toLowerCase());

                            const matchesFilter = currentFilter === 'all' || card.getAttribute('data-type') === currentFilter;

                            if (matchesSearch && matchesFilter) {
                                card.style.display = 'block';
                                visibleCount++;
                            } else {
                                card.style.display = 'none';
                            }
                        });

                        // Sort visible cards
                        sortCards();

                        // Update UI
                        updateSearchInfo(query, visibleCount);
                        updateResultCount(visibleCount);
                        showLoading(false);

                        // Show no results if needed
                        noResults.style.display = visibleCount === 0 ? 'block' : 'none';
                        contentGrid.style.display = visibleCount === 0 ? 'none' : 'grid';
                    }, 300);
                }

                function applyFilters() {
                    const query = searchInput.value.trim();
                    performSearch(query);
                    updateFilterCounts();
                }

                function sortCards() {
                    const cards = Array.from(contentGrid.querySelectorAll('.course-card'));
                    const visibleCards = cards.filter(card => card.style.display !== 'none');

                    visibleCards.sort((a, b) => {
                        const aTitle = a.getAttribute('data-title');
                        const bTitle = b.getAttribute('data-title');
                        const aDate = new Date(a.getAttribute('data-date'));
                        const bDate = new Date(b.getAttribute('data-date'));

                        switch (currentSort) {
                            case 'name-asc':
                                return aTitle.localeCompare(bTitle);
                            case 'name-desc':
                                return bTitle.localeCompare(aTitle);
                            case 'date-desc':
                                return bDate - aDate;
                            case 'date-asc':
                                return aDate - bDate;
                            default:
                                return 0;
                        }
                    });

                    // Reorder DOM elements
                    visibleCards.forEach(card => contentGrid.appendChild(card));
                }

                function updateSearchInfo(query, count) {
                    if (query || currentFilter !== 'all') {
                        let text = '';
                        if (query && currentFilter !== 'all') {
                            text = `Recherche "${query}" dans "${getFilterLabel(currentFilter)}" : ${count} résultat(s)`;
                        } else if (query) {
                            text = `Recherche "${query}" : ${count} résultat(s)`;
                        } else {
                            text = `Filtre "${getFilterLabel(currentFilter)}" : ${count} résultat(s)`;
                        }

                        searchResultText.textContent = text;
                        searchInfo.style.display = 'block';
                    } else {
                        searchInfo.style.display = 'none';
                    }
                }

                function updateResultCount(count) {
                    resultCount.textContent = `${count} élément${count > 1 ? 's' : ''} trouvé${count > 1 ? 's' : ''}`;
                }

                function updateFilterCounts() {
                    const cards = Array.from(contentGrid.querySelectorAll('.course-card'));
                    const counts = {
                        all: cards.length,
                        cours: cards.filter(card => card.getAttribute('data-type') === 'cours').length,
                        exercice: cards.filter(card => card.getAttribute('data-type') === 'exercice').length,
                        quiz: cards.filter(card => card.getAttribute('data-type') === 'quiz').length,
                        evaluation: cards.filter(card => card.getAttribute('data-type') === 'evaluation').length
                    };

                    Object.keys(counts).forEach(type => {
                        const countElement = document.getElementById(`count-${type}`);
                        if (countElement) {
                            countElement.textContent = counts[type];
                        }
                    });
                }

                function getFilterLabel(filter) {
                    const labels = {
                        'all': 'Tous les types',
                        'cours': 'Cours',
                        'exercice': 'Exercices',
                        'quiz': 'Quiz',
                        'evaluation': 'Évaluations'
                    };
                    return labels[filter] || filter;
                }

                function showLoading(show) {
                    loadingState.style.display = show ? 'block' : 'none';
                    contentGrid.style.display = show ? 'none' : 'grid';
                }

                // Initialize
                updateFilterCounts();
                updateResultCount(document.querySelectorAll('.course-card').length);
            });

            // Global functions
            function clearAllFilters() {
                document.getElementById('contentSearch').value = '';
                document.getElementById('clearSearch').style.display = 'none';
                document.querySelector('.filter-option[data-filter="all"]').click();
                document.getElementById('searchInfo').style.display = 'none';

                // Reset to default view
                document.querySelectorAll('.course-card').forEach(card => {
                    card.style.display = 'block';
                });

                document.getElementById('noResults').style.display = 'none';
                document.getElementById('module-content-list').style.display = 'grid';
                document.getElementById('resultCount').textContent = '4 éléments trouvés';
            }

            function exportContent() {
                // Simulate export functionality
                const visibleCards = Array.from(document.querySelectorAll('.course-card')).filter(card => card.style.display !== 'none');
                console.log('Exporting', visibleCards.length, 'items');

                // Show message
                showMessage(`Export de ${visibleCards.length} élément(s) en cours...`, 'info');
            }

            function bulkActions() {
                // Simulate bulk actions
                showMessage('Fonctionnalité d\'actions groupées à venir...', 'info');
            }

            function showMessage(message, type = 'info') {
                const alertDiv = document.createElement('div');
                alertDiv.className = `alert alert-${type} alert-dismissible fade show position-fixed`;
                alertDiv.style.cssText = 'top: 20px; right: 20px; z-index: 9999; min-width: 300px;';
                alertDiv.innerHTML = `
        ${message}
        <button type="button" class="btn-close" onclick="this.parentElement.remove()"></button>
    `;
                document.body.appendChild(alertDiv);

                setTimeout(() => {
                    if (alertDiv.parentNode) {
                        alertDiv.remove();
                    }
                }, 5000);
            }
        </script>

        <style>
            .search-container {
                min-width: 250px;
            }

            .dropdown-item.active {
                background-color: var(--primary-transparent);
                color: var(--primary);
            }

            .badge {
                font-size: 0.7rem;
            }

            .course-grid {
                display: grid;
                grid-template-columns: repeat(auto-fill, minmax(320px, 1fr));
                gap: 1.5rem;
            }

            .course-card {
                transition: all 0.3s ease;
            }

            .course-card:hover {
                transform: translateY(-5px);
                box-shadow: 0 8px 25px rgba(0, 0, 0, 0.15);
            }

            @media (max-width: 768px) {
                .card-header .d-flex {
                    flex-direction: column;
                    gap: 1rem;
                }

                .search-container {
                    min-width: 100%;
                }
            }
        </style>





        <!-- Quiz Generator Section -->
        <div class="content-section" id="quiz-generator">
            <h2 class="mb-4">Générateur de Quiz IA (RAG)</h2>

            <div class="quiz-generator">
                <form id="quizGeneratorForm">
                    <div class="form-row">
                        <div class="col">
                            <div class="mb-3">
                                <label class="form-label">Cours associé</label>
                                <select class="form-select" id="courseSelect" required>
                                    <option value="">Sélectionner un cours</option>
                                    <option value="algo">Algorithmique avancée</option>
                                    <option value="db">Base de données</option>
                                    <option value="ia">Intelligence Artificielle</option>
                                </select>
                            </div>
                        </div>
                        <div class="col">
                            <div class="mb-3">
                                <label class="form-label">Type de contenu</label>
                                <select class="form-select" id="contentTypeQuiz" required>
                                    <option value="">Sélectionner le type</option>
                                    <option value="quiz">Quiz</option>
                                    <option value="exercice">Exercices pratiques</option>
                                    <option value="evaluation">Évaluation</option>
                                    <option value="revision">Questions de révision</option>
                                </select>
                            </div>
                        </div>
                    </div>

                    <div class="form-row">
                        <div class="col">
                            <div class="mb-3">
                                <label class="form-label">Nombre de questions</label>
                                <input type="number" class="form-control" id="questionCount" min="5" max="50" value="10"
                                    required>
                            </div>
                        </div>
                        <div class="col">
                            <div class="mb-3">
                                <label class="form-label">Niveau de difficulté</label>
                                <select class="form-select" id="difficulty" required>
                                    <option value="">Sélectionner</option>
                                    <option value="debutant">Débutant</option>
                                    <option value="intermediaire">Intermédiaire</option>
                                    <option value="avance">Avancé</option>
                                    <option value="expert">Expert</option>
                                </select>
                            </div>
                        </div>
                        <div class="col">
                            <div class="mb-3">
                                <label class="form-label">Taxonomie de Bloom</label>
                                <select class="form-select" id="bloomLevel" required>
                                    <option value="">Sélectionner</option>
                                    <option value="connaissance">Connaissance</option>
                                    <option value="comprehension">Compréhension</option>
                                    <option value="application">Application</option>
                                    <option value="analyse">Analyse</option>
                                    <option value="synthese">Synthèse</option>
                                    <option value="evaluation">Évaluation</option>
                                </select>
                            </div>
                        </div>
                    </div>

                    <div class="form-row">
                        <div class="col">
                            <div class="mb-3">
                                <label class="form-label">Mot de passe du quiz</label>
                                <input type="text" class="form-control" id="quizPassword" placeholder="Optionnel">
                            </div>
                        </div>
                        <div class="col">
                            <div class="mb-3">
                                <label class="form-label">Durée (minutes)</label>
                                <input type="number" class="form-control" id="quizDuration" min="5" max="180"
                                    value="30">
                            </div>
                        </div>
                    </div>

                    <div class="mb-3">
                        <label class="form-label">Description (Optionnel)</label>
                        <textarea class="form-control" id="quizDescription" rows="3"
                            placeholder="Instructions, contexte, objectifs..."></textarea>
                    </div>

                    <div class="d-flex gap-2">
                        <button type="submit" class="btn btn-primary">
                            <i class="fas fa-magic"></i>
                            Générer avec l'IA
                        </button>
                        <button type="button" class="btn btn-outline" onclick="previewQuizSettings()">
                            <i class="fas fa-eye"></i>
                            Aperçu
                        </button>
                        <button type="reset" class="btn btn-outline">
                            <i class="fas fa-undo"></i>
                            Réinitialiser
                        </button>
                    </div>
                </form>

                <div id="generationResult" class="mt-4" style="display: none;">
                    <div class="alert alert-success">
                        <h5><i class="fas fa-check-circle me-2"></i>Quiz généré avec succès !</h5>
                        <p class="mb-0">Le quiz a été créé et est maintenant disponible pour vos étudiants.</p>
                    </div>
                </div>
            </div>
        </div>

        <!-- Quiz List Section -->
        <div class="content-section" id="quiz-list">
            <div class="d-flex justify-content-between align-items-center mb-4">
                <h2>Liste des Quiz et Exercices</h2>
                <div class="d-flex gap-2">
                    <select class="form-select" style="width: auto;">
                        <option>Tous les cours</option>
                        <option>Algorithmique avancée</option>
                        <option>Base de données</option>
                        <option>Intelligence Artificielle</option>
                    </select>
                    <button class="btn btn-primary" onclick="showSection('quiz-generator')">
                        <i class="fas fa-plus"></i>
                        Nouveau quiz
                    </button>
                </div>
            </div>

            <div class="card">
                <div class="card-body">
                    <div class="table-responsive">
                        <table class="table">
                            <thead>
                                <tr>
                                    <th>Titre</th>
                                    <th>Cours</th>
                                    <th>Type</th>
                                    <th>Questions</th>
                                    <th>Difficulté</th>
                                    <th>Date</th>
                                    <th>Actions</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr>
                                    <td>
                                        <div class="fw-semibold">Algorithmes de tri</div>
                                        <small class="text-muted">Bloom: Application</small>
                                    </td>
                                    <td>Algorithmique avancée</td>
                                    <td><span class="badge badge-primary">Quiz</span></td>
                                    <td>15</td>
                                    <td><span class="badge badge-warning">Intermédiaire</span></td>
                                    <td>25/05/2025</td>
                                    <td>
                                        <div class="d-flex gap-1">
                                            <button class="btn btn-sm btn-primary" title="Modifier">
                                                <i class="fas fa-edit"></i>
                                            </button>
                                            <button class="btn btn-sm btn-info" title="Aperçu">
                                                <i class="fas fa-eye"></i>
                                            </button>
                                            <button class="btn btn-sm btn-success" title="Statistiques">
                                                <i class="fas fa-chart-bar"></i>
                                            </button>
                                            <button class="btn btn-sm btn-danger" title="Supprimer">
                                                <i class="fas fa-trash"></i>
                                            </button>
                                        </div>
                                    </td>
                                </tr>
                                <tr>
                                    <td>
                                        <div class="fw-semibold">Requêtes SQL avancées</div>
                                        <small class="text-muted">Bloom: Analyse</small>
                                    </td>
                                    <td>Base de données</td>
                                    <td><span class="badge badge-success">Exercice</span></td>
                                    <td>20</td>
                                    <td><span class="badge badge-danger">Avancé</span></td>
                                    <td>23/05/2025</td>
                                    <td>
                                        <div class="d-flex gap-1">
                                            <button class="btn btn-sm btn-primary" title="Modifier">
                                                <i class="fas fa-edit"></i>
                                            </button>
                                            <button class="btn btn-sm btn-info" title="Aperçu">
                                                <i class="fas fa-eye"></i>
                                            </button>
                                            <button class="btn btn-sm btn-success" title="Statistiques">
                                                <i class="fas fa-chart-bar"></i>
                                            </button>
                                            <button class="btn btn-sm btn-danger" title="Supprimer">
                                                <i class="fas fa-trash"></i>
                                            </button>
                                        </div>
                                    </td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>
        </div>

        <!-- Students Section -->
        <div class="content-section" id="students">
            <div class="d-flex justify-content-between align-items-center mb-4">
                <h2>Mes Étudiants</h2>
                <div class="d-flex gap-2">
                    <input type="search" class="form-control" style="width: 250px;" placeholder="Rechercher...">
                    <select class="form-select" style="width: auto;">
                        <option>Tous les cours</option>
                        <option>Algorithmique avancée</option>
                        <option>Base de données</option>
                        <option>Intelligence Artificielle</option>
                    </select>
                    <button class="btn btn-primary">
                        <i class="fas fa-download"></i>
                        Exporter
                    </button>
                </div>
            </div>

            <div class="stats-grid mb-4">
                <div class="stat-card">
                    <div class="stat-header">
                        <div class="stat-icon">
                            <i class="fas fa-users"></i>
                        </div>
                        <div class="stat-value">234</div>
                    </div>
                    <div class="stat-label">Total étudiants</div>
                </div>
                <div class="stat-card">
                    <div class="stat-header">
                        <div class="stat-icon">
                            <i class="fas fa-user-check"></i>
                        </div>
                        <div class="stat-value">198</div>
                    </div>
                    <div class="stat-label">Actifs ce mois</div>
                </div>
                <div class="stat-card">
                    <div class="stat-header">
                        <div class="stat-icon">
                            <i class="fas fa-trophy"></i>
                        </div>
                        <div class="stat-value">87%</div>
                    </div>
                    <div class="stat-label">Taux de réussite</div>
                </div>
                <div class="stat-card">
                    <div class="stat-header">
                        <div class="stat-icon">
                            <i class="fas fa-clock"></i>
                        </div>
                        <div class="stat-value">4.2h</div>
                    </div>
                    <div class="stat-label">Temps moyen/semaine</div>
                </div>
            </div>

            <div class="card">
                <div class="card-body">
                    <div class="table-responsive">
                        <table class="table">
                            <thead>
                                <tr>
                                    <th>Étudiant</th>
                                    <th>Email</th>
                                    <th>Cours</th>
                                    <th>Dernière activité</th>
                                    <th>Moyenne</th>
                                    <th>Statut</th>
                                    <th>Actions</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr>
                                    <td>
                                        <div class="d-flex align-items-center gap-2">
                                            <div class="user-avatar"
                                                style="width: 35px; height: 35px; font-size: 0.9rem;">MD</div>
                                            <div>
                                                <div class="fw-semibold">Marie Dubois</div>
                                                <small class="text-muted">#2025001</small>
                                            </div>
                                        </div>
                                    </td>
                                    <td>marie.dubois@email.com</td>
                                    <td>3 cours</td>
                                    <td>Il y a 2 heures</td>
                                    <td>
                                        <span class="fw-semibold text-success">16.5/20</span>
                                        <div class="progress" style="height: 4px;">
                                            <div class="progress-bar bg-success" style="width: 82%"></div>
                                        </div>
                                    </td>
                                    <td><span class="badge badge-success">Actif</span></td>
                                    <td>
                                        <div class="d-flex gap-1">
                                            <button class="btn btn-sm btn-info" title="Détails">
                                                <i class="fas fa-eye"></i>
                                            </button>


                                            <button class="btn btn-sm btn-primary" title="Message">
                                                <i class="fas fa-envelope"></i>
                                            </button>
                                        </div>
                                    </td>
                                </tr>
                                <tr>
                                    <td>
                                        <div class="d-flex align-items-center gap-2">
                                            <div class="user-avatar"
                                                style="width: 35px; height: 35px; font-size: 0.9rem;">PL</div>
                                            <div>
                                                <div class="fw-semibold">Pierre Laurent</div>
                                                <small class="text-muted">#2025002</small>
                                            </div>
                                        </div>
                                    </td>
                                    <td>pierre.laurent@email.com</td>
                                    <td>2 cours</td>
                                    <td>Il y a 1 jour</td>
                                    <td>
                                        <span class="fw-semibold text-warning">14.2/20</span>
                                        <div class="progress" style="height: 4px;">
                                            <div class="progress-bar bg-warning" style="width: 71%"></div>
                                        </div>
                                    </td>
                                    <td><span class="badge badge-warning">Moyen</span></td>
                                    <td>
                                        <div class="d-flex gap-1">
                                            <button class="btn btn-sm btn-info" title="Détails">
                                                <i class="fas fa-eye"></i>
                                            </button>
                                            <button class="btn btn-sm btn-primary" title="Message">
                                                <i class="fas fa-envelope"></i>
                                            </button>
                                        </div>
                                    </td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>
        </div>

        <!-- Statistics Section -->
        <div class="content-section" id="statistics">
            <h2 class="mb-4">Statistiques</h2>

            <div class="row mb-4">
                <div class="col-md-6">
                    <div class="card">
                        <div class="card-header">
                            <h3 class="card-title">Performance par cours</h3>
                        </div>
                        <div class="card-body">
                            <div class="chart-container">
                                <canvas id="coursePerformanceChart"></canvas>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="col-md-6">
                    <div class="card">
                        <div class="card-header">
                            <h3 class="card-title">Évolution des inscriptions</h3>
                        </div>
                        <div class="card-body">
                            <div class="chart-container">
                                <canvas id="enrollmentChart"></canvas>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <div class="row">
                <div class="col-lg-4">
                    <div class="card">
                        <div class="card-header">
                            <h3 class="card-title">Quiz les plus difficiles</h3>
                        </div>
                        <div class="card-body">
                            <div class="d-flex flex-column gap-3">
                                <div class="d-flex justify-content-between align-items-center">
                                    <span>Algorithmes de tri</span>
                                    <span class="text-danger fw-bold">45% réussite</span>
                                </div>
                                <div class="d-flex justify-content-between align-items-center">
                                    <span>Requêtes complexes</span>
                                    <span class="text-warning fw-bold">62% réussite</span>
                                </div>
                                <div class="d-flex justify-content-between align-items-center">
                                    <span>Réseaux de neurones</span>
                                    <span class="text-success fw-bold">78% réussite</span>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="col-lg-8">
                    <div class="card">
                        <div class="card-header">
                            <h3 class="card-title">Recommandations IA</h3>
                        </div>
                        <div class="card-body">
                            <div class="alert alert-info">
                                <h6 class="fw-semibold">Suggestions basées sur l'analyse IA :</h6>
                                <ul class="mb-0">
                                    <li>Renforcer les exercices sur les algorithmes de tri (taux d'échec élevé)</li>
                                    <li>Pierre Laurent nécessite un suivi personnalisé en base de données</li>
                                    <li>Le cours d'IA connaît une excellente progression (+25% de réussite)</li>
                                </ul>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Messages Section -->
        <div class="content-section" id="messages">
            <div class="d-flex justify-content-between align-items-center mb-4">
                <h2>Messages</h2>
                <button class="btn btn-primary">
                    <i class="fas fa-plus"></i>
                    Nouveau message
                </button>
            </div>

            <div class="row">
                <div class="col-lg-4">
                    <div class="card">
                        <div class="card-header">
                            <h3 class="card-title">Conversations</h3>
                        </div>
                        <div class="card-body p-0">
                            <div class="list-group list-group-flush">
                                <a href="#" class="list-group-item list-group-item-action active">
                                    <div class="d-flex align-items-center gap-3">
                                        <div class="user-avatar" style="width: 40px; height: 40px;">MD</div>
                                        <div class="flex-grow-1">
                                            <div class="fw-semibold">Marie Dubois</div>
                                            <small class="text-muted">Question sur le devoir...</small>
                                        </div>
                                        <span class="badge badge-primary">2</span>
                                    </div>
                                </a>
                                <a href="#" class="list-group-item list-group-item-action">
                                    <div class="d-flex align-items-center gap-3">
                                        <div class="user-avatar" style="width: 40px; height: 40px;">PL</div>
                                        <div class="flex-grow-1">
                                            <div class="fw-semibold">Pierre Laurent</div>
                                            <small class="text-muted">Demande d'aide SQL</small>
                                        </div>
                                    </div>
                                </a>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="col-lg-8">
                    <div class="card">
                        <div class="card-header">
                            <div class="d-flex align-items-center gap-3">
                                <div class="user-avatar">MD</div>
                                <div>
                                    <div class="fw-semibold">Marie Dubois</div>
                                    <small class="text-muted">En ligne</small>
                                </div>
                            </div>
                        </div>
                        <div class="card-body" style="height: 400px; overflow-y: auto;">
                            <div class="d-flex flex-column gap-2">
                                <div class="message received">
                                    Bonjour Professeur, j'ai une question concernant l'exercice 3 du TP.
                                </div>
                                <div class="message sent">
                                    Bonjour Marie, quel est le problème exactement ?
                                </div>
                                <div class="message received">
                                    Je ne comprends pas comment implémenter l'algorithme de tri fusion. Pouvez-vous
                                    m'expliquer ?
                                </div>
                            </div>
                        </div>
                        <div class="card-footer">
                            <div class="input-group">
                                <input type="text" class="form-control" placeholder="Écrire un message...">
                                <button class="btn btn-primary">
                                    <i class="fas fa-paper-plane"></i>
                                </button>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Settings Section -->
        <div class="content-section" id="settings">
            <h2 class="mb-4">Paramètres</h2>

            <div class="row">
                <div class="col-lg-6">
                    <div class="card">
                        <div class="card-header">
                            <h3 class="card-title">Profil</h3>
                        </div>
                        <div class="card-body">
                            <form>
                                <div class="mb-3">
                                    <label class="form-label">Nom complet</label>
                                    <input type="text" class="form-control" value="Jean Dupont">
                                </div>
                                <div class="mb-3">
                                    <label class="form-label">Email</label>
                                    <input type="email" class="form-control" value="jean.dupont@kalanso.edu">
                                </div>
                                <div class="mb-3">
                                    <label class="form-label">Spécialité</label>
                                    <input type="text" class="form-control" value="Informatique">
                                </div>
                                <div class="mb-3">
                                    <label class="form-label">Bio</label>
                                    <textarea class="form-control"
                                        rows="3">Professeur d'informatique spécialisé en algorithmique et bases de données.</textarea>
                                </div>
                                <button type="submit" class="btn btn-primary">Enregistrer</button>
                            </form>
                        </div>
                    </div>
                </div>
                <div class="col-lg-6">
                    <div class="card">
                        <div class="card-header">
                            <h3 class="card-title">Sécurité</h3>
                        </div>
                        <div class="card-body">
                            <form>
                                <div class="mb-3">
                                    <label class="form-label">Mot de passe actuel</label>
                                    <input type="password" class="form-control">
                                </div>
                                <div class="mb-3">
                                    <label class="form-label">Nouveau mot de passe</label>
                                    <input type="password" class="form-control">
                                </div>
                                <div class="mb-3">
                                    <label class="form-label">Confirmer le nouveau mot de passe</label>
                                    <input type="password" class="form-control">
                                </div>
                                <button type="submit" class="btn btn-primary">Changer le mot de passe</button>
                            </form>
                        </div>
                    </div>

                    <div class="card mt-4">
                        <div class="card-header">
                            <h3 class="card-title">Préférences</h3>
                        </div>
                        <div class="card-body">
                            <div class="mb-3">
                                <label class="form-label">Thème</label>
                                <select class="form-select" id="themePreference">
                                    <option value="dark">Sombre</option>
                                    <option value="light">Clair</option>
                                    <option value="system">Système</option>
                                </select>
                            </div>
                            <div class="form-check form-switch mb-3">
                                <input class="form-check-input" type="checkbox" id="notificationsSwitch" checked>
                                <label class="form-check-label" for="notificationsSwitch">Notifications par
                                    email</label>
                            </div>
                            <div class="form-check form-switch">
                                <input class="form-check-input" type="checkbox" id="weeklyReportSwitch" checked>
                                <label class="form-check-label" for="weeklyReportSwitch">Rapport hebdomadaire</label>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Modal de Création de Module -->
    <div class="modal fade" id="createCourseModal" tabindex="-1" aria-hidden="true">
        <div class="modal-dialog modal-lg">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title">Créer un nouveau Module</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body">
                    <form id="createModuleForm">
                        {% csrf_token %}
                        <div class="row">
                            <div class="col-md-6">
                                <div class="mb-3">
                                    <label class="form-label">Titre</label>
                                    <input type="text" class="form-control" id="module-titre" name="titre" required>
                                </div>
                                <div class="mb-3">
                                    <label class="form-label">Code du Module</label>
                                    <input type="text" class="form-control" id="module-code" name="code"
                                        placeholder="Ex: BD2034" required>
                                </div>

                            </div>
                            <div class="col-md-6">
                                <div class="mb-3">
                                    <label class="form-label">Niveau</label>
                                    <select class="form-select" id="module-level" name="niveau" required>
                                        <option value="">Sélectionner</option>
                                        <option value="debutant">Débutant</option>
                                        <option value="intermediaire">Intermédiaire</option>
                                        <option value="avance">Avancé</option>
                                    </select>
                                </div>
                                <div class="mb-3">
                                    <label class="form-label">Domaine</label>
                                    <select class="form-select" id="module-domain" name="domaine" required>
                                        <option value="">Sélectionner</option>
                                        <option value="informatique">Informatique</option>
                                        <option value="mathematiques">Mathématiques</option>
                                        <option value="sciences">Sciences</option>
                                        <option value="lettres">Lettres</option>
                                    </select>
                                </div>
                                <!-- <div class="mb-3">
                                <label class="form-label">Fichier du cours</label>
                                <input type="file" class="form-control" id="course-file" name="fichier" accept=".pdf,.doc,.docx,.ppt,.pptx">
                                <small class="text-muted">Formats acceptés: PDF, DOC, DOCX, PPT, PPTX (Max: 50MB)</small>
                            </div> -->
                            </div>
                        </div>
                        <div class="mb-3">
                            <label class="form-label">Description</label>
                            <textarea class="form-control" rows="4" id="module-description" name="description"
                                required></textarea>
                        </div>
                    </form>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-outline-secondary" data-bs-dismiss="modal">Annuler</button>
                    <button type="submit" form="createModuleForm" class="btn btn-primary" id="create-course-btn">
                        <span class="btn-text">Créer le cours</span>
                        <span class="btn-loading" style="display: none;">
                            <i class="fas fa-spinner fa-spin"></i>
                            Création...
                        </span>
                    </button>
                </div>
            </div>
        </div>
    </div>

    <!-- Modal de Confirmation de Suppression -->
    <div class="modal fade" id="deleteModuleModal" tabindex="-1" aria-hidden="true">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title">Confirmer la suppression</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body">
                    <div class="text-center">
                        <i class="fas fa-exclamation-triangle fa-3x text-warning mb-3"></i>
                        <h5>Êtes-vous sûr ?</h5>
                        <p class="text-muted">Cette action supprimera définitivement le module "<span
                                id="module-to-delete-name"></span>" et toutes ses données associées.</p>
                        <p class="text-danger"><strong>Cette action est irréversible.</strong></p>
                    </div>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-outline-secondary" data-bs-dismiss="modal">Annuler</button>
                    <button type="button" class="btn btn-danger" id="confirm-delete-btn"
                        onclick="confirmDeleteModule()">
                        <span class="btn-text">Supprimer</span>
                        <span class="btn-loading" style="display: none;">
                            <i class="fas fa-spinner fa-spin"></i>
                            Suppression...
                        </span>
                    </button>
                </div>
            </div>
        </div>
    </div>

    <!-- Section Modules avec boutons de suppression -->
    <div class="content-section" id="courses">
        <div class="d-flex justify-content-between align-items-center mb-4">
            <h2>Mes Modules</h2>
            <button class="btn btn-primary" onclick="openCreateCourseModal()">
                <i class="fas fa-plus"></i>
                Ajouter un nouveau module
            </button>
        </div>

        <div class="course-grid" id="modules-container">
            <!-- Les modules seront chargés dynamiquement -->
        </div>
    </div>

    <script>
        // Variables globales
        let moduleToDelete = null;

        // Fonction pour ouvrir le modal de création
        function openCreateCourseModal() {
            const modal = new bootstrap.Modal(document.getElementById('createCourseModal'));
            modal.show();

            // Réinitialiser le formulaire
            document.getElementById('createModuleForm').reset();
        }


        // Fonction pour créer un module
        document.getElementById('createModuleForm').addEventListener('submit', async function (e) {
            e.preventDefault();

            const createBtn = document.getElementById('create-course-btn');
            const btnText = createBtn.querySelector('.btn-text');
            const btnLoading = createBtn.querySelector('.btn-loading');

            // Afficher le loading
            btnText.style.display = 'none';
            btnLoading.style.display = 'inline';
            createBtn.disabled = true;

            try {
                const formData = new FormData();

                // Récupérer les données du formulaire
                formData.append('titre', document.getElementById('module-titre').value);
                formData.append('code', document.getElementById('module-code').value);
                formData.append('domaine', document.getElementById('module-domain').value);
                formData.append('niveau', document.getElementById('module-level').value);
                formData.append('description', document.getElementById('module-description').value);
                console.log('Form data:', Object.fromEntries(formData.entries()));
                // Ajouter le fichier s'il existe
                // const fileInput = document.getElementById('course-file');
                // if (fileInput.files[0]) {
                //     formData.append('fichier', fileInput.files[0]);
                // }

                // Envoyer la requête à Django
                const response = await fetch('/api/modules/create/', {
                    method: 'POST',
                    body: formData,
                    headers: {
                        'X-CSRFToken': getCsrfToken()
                    }
                });

                const data = await response.json();

                if (response.ok) {
                    // Succès
                    showMessage('Module créé avec succès!', 'success');

                    // Fermer le modal
                    bootstrap.Modal.getInstance(document.getElementById('createCourseModal')).hide();

                    // Ajouter le nouveau module à l'interface
                    addModuleToGrid(data.module);

                    // Réinitialiser le formulaire
                    document.getElementById('createModuleForm').reset();

                } else {
                    // Erreur
                    showMessage(data.error || 'Erreur lors de la création du module', 'danger');
                }

            } catch (error) {
                console.error('Erreur:', error);
                showMessage('Erreur de connexion', 'danger');
            } finally {
                // Masquer le loading
                btnText.style.display = 'inline';
                btnLoading.style.display = 'none';
                createBtn.disabled = false;
            }
        });

        // Fonction pour ajouter un module à la grille
        function addModuleToGrid(module) {
            const container = document.getElementById('modules-list');
            const moduleCard = createModuleCard(module);
            container.appendChild(moduleCard);
        }

        // Fonction pour créer une carte de module
        function createModuleCard(module) {
            const card = document.createElement('div');
            card.className = 'course-card';
            card.setAttribute('data-module-id', module.id);

            // Déterminer l'icône selon le domaine
            const domainIcons = {
                'informatique': 'fas fa-code',
                'mathematiques': 'fas fa-calculator',
                'sciences': 'fas fa-flask',
                'lettres': 'fas fa-book'
            };

            const icon = domainIcons[module.domaine] || 'fas fa-graduation-cap';

            card.innerHTML = `
        <div class="course-image">
            <i class="${icon}"></i>
        </div>
        <div class="course-content">
            <h4 class="course-title">${module.titre}</h4>
            <div class="course-meta">
                Code: ${module.code || 'N/A'} • Niveau: ${module.niveau || 'N/A'}
                <br>
                <small class="text-muted">Créé le ${formatDate(module.date_creation)}</small>
            </div>
            <div class="course-description">
                <p class="text-muted small">${module.description.substring(0, 100)}${module.description.length > 100 ? '...' : ''}</p>
            </div>
            <div class="course-actions mt-3">
                <button class="btn btn-sm btn-primary" onclick="editModule(${module.id})">
                    <i class="fas fa-edit"></i>
                    Modifier
                </button>
                <button class="btn btn-sm btn-success" onclick="showModuleDetails('${module.titre}', '${module.code}')">
                    <i class="fas fa-eye"></i>
                    Détails
                </button>
                <button class="btn btn-sm btn-danger" onclick="deleteModule(${module.id}, '${module.titre}')">
                    <i class="fas fa-trash"></i>
                    Supprimer
                </button>
            </div>
        </div>
    `;

            return card;
        }

        // Fonction pour supprimer un module
        function deleteModule(moduleId, moduleName) {
            moduleToDelete = moduleId;
            document.getElementById('module-to-delete-name').textContent = moduleName;

            const modal = new bootstrap.Modal(document.getElementById('deleteModuleModal'));
            modal.show();
        }

        // Fonction pour confirmer la suppression
        async function confirmDeleteModule() {
            if (!moduleToDelete) return;

            const deleteBtn = document.getElementById('confirm-delete-btn');
            const btnText = deleteBtn.querySelector('.btn-text');
            const btnLoading = deleteBtn.querySelector('.btn-loading');

            // Afficher le loading
            btnText.style.display = 'none';
            btnLoading.style.display = 'inline';
            deleteBtn.disabled = true;

            try {
                const response = await fetch(`/api/modules/${moduleToDelete}/delete/`, {
                    method: 'DELETE',
                    headers: {
                        'X-CSRFToken': getCsrfToken(),
                        'Content-Type': 'application/json'
                    }
                });

                const data = await response.json();

                if (response.ok) {
                    // Succès
                    showMessage('Module supprimé avec succès!', 'success');

                    // Supprimer l'élément du DOM
                    const moduleCard = document.querySelector(`[data-module-id="${moduleToDelete}"]`);
                    if (moduleCard) {
                        moduleCard.remove();
                    }

                    // Fermer le modal
                    bootstrap.Modal.getInstance(document.getElementById('deleteModuleModal')).hide();

                } else {
                    // Erreur
                    showMessage(data.error || 'Erreur lors de la suppression', 'danger');
                }

            } catch (error) {
                console.error('Erreur:', error);
                showMessage('Erreur de connexion', 'danger');
            } finally {
                // Masquer le loading
                btnText.style.display = 'inline';
                btnLoading.style.display = 'none';
                deleteBtn.disabled = false;
                moduleToDelete = null;
            }
        }

        // Fonction pour charger les modules existants
        async function loadModules() {
            try {
                const response = await fetch('/api/modules/');
                const data = await response.json();

                if (response.ok) {
                    const container = document.getElementById('modules-container');
                    container.innerHTML = '';

                    data.modules.forEach(module => {
                        addModuleToGrid(module);
                    });
                } else {
                    showMessage('Erreur lors du chargement des modules', 'danger');
                }
            } catch (error) {
                console.error('Erreur:', error);
                showMessage('Erreur de connexion', 'danger');
            }
        }

        // Fonction pour éditer un module
        function editModule(moduleId) {
            // Vous pouvez implémenter cette fonction pour ouvrir un modal d'édition
            showMessage('Fonctionnalité d\'édition à venir...', 'info');
        }

        // Fonctions utilitaires
        function getCsrfToken() {
            return document.querySelector('[name=csrfmiddlewaretoken]').value;
        }

        function formatDate(dateString) {
            const date = new Date(dateString);
            return date.toLocaleDateString('fr-FR', {
                year: 'numeric',
                month: 'short',
                day: 'numeric'
            });
        }

        function showMessage(message, type = 'info') {
            const alertDiv = document.createElement('div');
            alertDiv.className = `alert alert-${type} alert-dismissible fade show position-fixed`;
            alertDiv.style.cssText = 'top: 20px; right: 20px; z-index: 9999; min-width: 300px;';
            alertDiv.innerHTML = `
        ${message}
        <button type="button" class="btn-close" onclick="this.parentElement.remove()"></button>
    `;
            document.body.appendChild(alertDiv);

            setTimeout(() => {
                if (alertDiv.parentNode) {
                    alertDiv.remove();
                }
            }, 5000);
        }

        // Charger les modules au démarrage
        document.addEventListener('DOMContentLoaded', function () {
            loadModules();
        });
    </script>

    <style>
        /* Styles spécifiques */
        .course-description {
            margin: 0.5rem 0;
        }

        .btn-loading {
            display: none;
        }

        .course-card[data-module-id] {
            transition: all 0.3s ease;
        }

        .course-card[data-module-id]:hover {
            transform: translateY(-3px);
            box-shadow: 0 8px 25px rgba(0, 0, 0, 0.15);
        }

        .modal-content {
            border-radius: 12px;
        }

        .alert-dismissible {
            padding-right: 3rem;
        }

        @media (max-width: 768px) {
            .course-actions {
                display: flex;
                flex-wrap: wrap;
                gap: 0.25rem;
            }

            .course-actions .btn {
                flex: 1;
                min-width: 0;
            }
        }
    </style>
    <!-- Preview Quiz Modal -->
    <div class="modal fade" id="previewQuizModal" tabindex="-1" aria-hidden="true">
        <div class="modal-dialog modal-lg">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title">Aperçu des paramètres du quiz</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body">
                    <div class="alert alert-info">
                        <i class="fas fa-info-circle me-2"></i>
                        Ceci est un aperçu des paramètres qui seront utilisés pour générer le quiz avec l'IA.
                    </div>
                    <div class="table-responsive">
                        <table class="table">
                            <tbody>
                                <tr>
                                    <th width="30%">Cours associé</th>
                                    <td>Algorithmique avancée</td>
                                </tr>
                                <tr>
                                    <th>Type de contenu</th>
                                    <td>Quiz</td>
                                </tr>
                                <tr>
                                    <th>Nombre de questions</th>
                                    <td>10</td>
                                </tr>
                                <tr>
                                    <th>Niveau de difficulté</th>
                                    <td>Intermédiaire</td>
                                </tr>
                                <tr>
                                    <th>Taxonomie de Bloom</th>
                                    <td>Application</td>
                                </tr>
                                <tr>
                                    <th>Durée</th>
                                    <td>30 minutes</td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-outline" data-bs-dismiss="modal">Fermer</button>
                    <button type="button" class="btn btn-primary">Générer le quiz</button>
                </div>
            </div>
        </div>
    </div>

    <div class="modal fade" id="createContentModal" tabindex="-1" aria-labelledby="createContentModalLabel"
        aria-hidden="true">
        <div class="modal-dialog modal-lg">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title">Ajouter du contenu</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body">
                    <form id="createContentForm">
                        <!-- Type Selection -->
                        <div class="mb-3">
                            <label class="form-label">Type de contenu <span class="text-danger">*</span></label>
                            <select class="form-select" id="contentType" name="contentType" required>
                                <option value="">Sélectionner le type</option>
                                <option value="cours">Cours</option>
                                <option value="exercice">Exercice (IA)</option>
                                <option value="quiz">Quiz (IA)</option>
                                <option value="evaluation">Évaluation (IA)</option>
                            </select>
                        </div>

                        <!-- Common Fields -->
                        <div class="row">
                            <div class="col-md-6">
                                <div class="mb-3">
                                    <label class="form-label">Titre <span class="text-danger">*</span></label>
                                    <input type="text" class="form-control" id="contentTitle" name="title" required>
                                </div>
                            </div>
                            <div class="col-md-6">
                                <div class="mb-3">
                                    <label class="form-label">Code <span class="text-danger">*</span></label>
                                    <input type="text" class="form-control" id="contentCode" name="code" required>
                                </div>
                            </div>
                        </div>

                        <div class="mb-3">
                            <label class="form-label">Domaine <span class="text-danger">*</span></label>
                            <select class="form-select" id="contentDomain" name="domain" required>
                                <option value="">Sélectionner</option>
                                <option value="informatique">Informatique</option>
                                <option value="mathematiques">Mathématiques</option>
                                <option value="sciences">Sciences</option>
                                <option value="lettres">Lettres</option>
                                <option value="histoire">Histoire-Géographie</option>
                                <option value="langues">Langues</option>
                            </select>
                        </div>

                        <!-- Course Specific Fields -->
                        <div id="courseFields" style="display: none;">
                            <div class="mb-3">
                                <label class="form-label">Fichier du cours</label>
                                <input type="file" class="form-control" id="courseFile" name="courseFile"
                                    accept=".pdf,.doc,.docx,.ppt,.pptx">
                                <div class="form-text">Formats acceptés: PDF, Word, PowerPoint (Max 10MB)</div>
                            </div>

                            <div class="row">
                                <div class="col-md-6">
                                    <div class="mb-3">
                                        <label class="form-label">Durée estimée (heures)</label>
                                        <input type="number" class="form-control" name="duration" min="1" max="50">
                                    </div>
                                </div>
                                <div class="col-md-6">
                                    <div class="mb-3">
                                        <label class="form-label">Niveau de difficulté</label>
                                        <select class="form-select" name="difficulty">
                                            <option value="">Sélectionner</option>
                                            <option value="debutant">Débutant</option>
                                            <option value="intermediaire">Intermédiaire</option>
                                            <option value="avance">Avancé</option>
                                        </select>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- AI Generated Content Fields (Quiz, Exercise, Evaluation) -->
                        <div id="aiFields" style="display: none;">
                            <div class="alert alert-info">
                                <i class="fas fa-robot me-2"></i>
                                <strong>Contenu généré par IA</strong> - Configurez les paramètres ci-dessous pour que
                                l'IA génère automatiquement le contenu.
                            </div>

                            <div class="row">
                                <div class="col-md-4">
                                    <div class="mb-3">
                                        <label class="form-label">Nombre de questions <span
                                                class="text-danger">*</span></label>
                                        <select class="form-select" name="questionCount">
                                            <option value="">Nombre</option>
                                            <option value="5">5 questions</option>
                                            <option value="10">10 questions</option>
                                            <option value="15">15 questions</option>
                                            <option value="20">20 questions</option>
                                            <option value="25">25 questions</option>
                                            <option value="30">30 questions</option>
                                        </select>
                                    </div>
                                </div>
                                <div class="col-md-4">
                                    <div class="mb-3">
                                        <label class="form-label">Niveau de difficulté <span
                                                class="text-danger">*</span></label>
                                        <select class="form-select" name="aiDifficulty">
                                            <option value="">Difficulté</option>
                                            <option value="debutant">Débutant</option>
                                            <option value="intermediaire">Intermédiaire</option>
                                            <option value="avance">Avancé</option>
                                            <option value="expert">Expert</option>
                                        </select>
                                    </div>
                                </div>
                                <div class="col-md-4">
                                    <div class="mb-3">
                                        <label class="form-label">Taxonomie de Bloom <span
                                                class="text-danger">*</span></label>
                                        <select class="form-select" name="bloomLevel">
                                            <option value="">Niveau Bloom</option>
                                            <option value="connaissance">Connaissance</option>
                                            <option value="comprehension">Compréhension</option>
                                            <option value="application">Application</option>
                                            <option value="analyse">Analyse</option>
                                            <option value="synthese">Synthèse</option>
                                            <option value="evaluation">Évaluation</option>
                                        </select>
                                    </div>
                                </div>
                            </div>

                            <div class="row">
                                <div class="col-md-6">
                                    <div class="mb-3">
                                        <label class="form-label">Durée (minutes)</label>
                                        <input type="number" class="form-control" name="aiDuration" placeholder="30"
                                            min="5" max="180">
                                    </div>
                                </div>
                                <div class="col-md-6">
                                    <div class="mb-3">
                                        <label class="form-label">Type de questions</label>
                                        <select class="form-select" name="questionType">
                                            <option value="mixte">Mixte (QCM + Texte libre)</option>
                                            <option value="qcm">QCM uniquement</option>
                                            <option value="texte">Texte libre uniquement</option>
                                            <option value="vrai_faux">Vrai/Faux</option>
                                        </select>
                                    </div>
                                </div>
                            </div>
                            <div class="row">
                                <div class="col-md-12 mb-3">
                                    <label class="form-label">Sélectionner le Cours</label>
                                    <select name="liste_cours" class="form-select">

                                        {% for course in courses %}
                                        <option value="{{ course.id }}">{{ course.titre }}</option>
                                        {% endfor %}

                                    </select>
                                </div>
                            </div>

                            <!-- Exercise specific fields -->
                            <div id="exerciseSpecific" style="display: none;">
                                <div class="mb-3">
                                    <label class="form-label">Type d'exercice</label>
                                    <select class="form-select" name="exerciseType">
                                        <option value="pratique">Exercices pratiques</option>
                                        <option value="problemes">Résolution de problèmes</option>
                                        <option value="cas_etude">Études de cas</option>
                                        <option value="simulation">Simulations</option>
                                    </select>
                                </div>
                            </div>

                            <!-- Evaluation specific fields -->
                            <div id="evaluationSpecific" style="display: none;">
                                <div class="row">
                                    <div class="col-md-6">
                                        <div class="mb-3">
                                            <label class="form-label">Type d'évaluation</label>
                                            <select class="form-select" name="evaluationType">
                                                <option value="formative">Évaluation formative</option>
                                                <option value="sommative">Évaluation sommative</option>
                                                <option value="diagnostique">Évaluation diagnostique</option>
                                            </select>
                                        </div>
                                    </div>
                                    <div class="col-md-6">
                                        <div class="mb-3">
                                            <label class="form-label">Note maximale</label>
                                            <input type="number" class="form-control" name="maxScore" value="20"
                                                min="10" max="100">
                                        </div>
                                    </div>
                                </div>
                            </div>

                            <div class="mb-3">
                                <label class="form-label">Instructions spéciales pour l'IA</label>
                                <textarea class="form-control" name="aiInstructions" rows="2"
                                    placeholder="Ex: Inclure des exemples concrets, se concentrer sur les aspects pratiques..."></textarea>
                            </div>
                        </div>

                        <!-- Common Description -->
                        <div class="mb-3">
                            <label class="form-label">Description <span class="text-danger">*</span></label>
                            <textarea class="form-control" id="contentDescription" name="description" rows="3" required
                                placeholder="Description du contenu, objectifs pédagogiques..."></textarea>
                        </div>

                        <!-- Advanced Settings -->
                        <div class="card mt-3">
                            <div class="card-header">
                                <h6 class="mb-0">
                                    <button class="btn btn-link p-0" type="button" data-bs-toggle="collapse"
                                        data-bs-target="#advancedSettings">
                                        <i class="fas fa-cog me-2"></i>Paramètres avancés (optionnel)
                                    </button>
                                </h6>
                            </div>
                            <div class="collapse" id="advancedSettings">
                                <div class="card-body">
                                    <div class="row">
                                        <div class="col-md-6">
                                            <div class="mb-3">
                                                <label class="form-label">Mot de passe d'accès</label>
                                                <input type="text" class="form-control" name="accessPassword"
                                                    placeholder="Optionnel">
                                            </div>
                                        </div>
                                        <div class="col-md-6">
                                            <div class="mb-3">
                                                <label class="form-label">Date de publication</label>
                                                <input type="datetime-local" class="form-control" name="publishDate">
                                            </div>
                                        </div>
                                    </div>
                                    <div class="form-check">
                                        <input class="form-check-input" type="checkbox" name="isPublic" id="isPublic"
                                            checked>
                                        <label class="form-check-label" for="isPublic">
                                            Visible par tous les étudiants inscrits
                                        </label>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </form>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-outline" data-bs-dismiss="modal">Annuler</button>
                    <button type="submit" form="createContentForm" class="btn btn-primary" id="submitBtn">
                        <span id="submitText">Créer</span>
                        <span id="submitLoader" style="display: none;">
                            <span class="spinner-border spinner-border-sm me-2"></span>Création...
                        </span>
                    </button>
                </div>
            </div>
        </div>






    </div>



    <!-- Modal Markdown -->
    <div class="modal fade" id="markdownModal" tabindex="-1" aria-labelledby="markdownModalLabel" aria-hidden="true">
        <div class="modal-dialog modal-lg modal-dialog-scrollable">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title" id="markdownModalLabel">Feedback</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Fermer"></button>
                </div>
                <div class="modal-body">
                    <div id="markdownContent"></div>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Fermer</button>
                </div>
            </div>
        </div>
    </div>
    <script src="https://cdn.jsdelivr.net/npm/marked/marked.min.js"></script>

    <style>
        /* Styles spécifiques aux sections */
        .course-info-panel {
            background: var(--bg-darker);
            border-radius: 8px;
            padding: 1.5rem;
            height: fit-content;
        }

        .info-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 0.5rem 0;
            border-bottom: 1px solid var(--border-color);
        }

        .info-item:last-child {
            border-bottom: none;
        }

        .pdf-preview-container {
            background: var(--bg-card);
            border-radius: 8px;
            overflow: hidden;
            height: 600px;
            display: flex;
            flex-direction: column;
        }

        .pdf-toolbar {
            background: var(--bg-darker);
            padding: 0.75rem 1rem;
            border-bottom: 1px solid var(--border-color);
        }

        .pdf-controls {
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        .zoom-level {
            padding: 0 0.5rem;
            color: var(--text-muted);
            font-size: 0.875rem;
        }

        .pdf-viewer-wrapper {
            flex: 1;
            position: relative;
        }

        .course-pdf-display {
            width: 100%;
            height: 100%;
        }

        .pdf-fallback {
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            height: 100%;
            text-align: center;
            padding: 2rem;
        }

        .file-actions .btn {
            margin-right: 0.5rem;
        }

        .generation-info {
            background: var(--bg-darker);
            border-radius: 8px;
            padding: 1.5rem;
        }

        .stat-item {
            text-align: center;
        }

        .stat-label {
            display: block;
            color: var(--text-muted);
            font-size: 0.875rem;
            margin-bottom: 0.25rem;
        }

        .stat-value {
            display: block;
            color: var(--text-light);
            font-weight: 600;
            font-size: 1.1rem;
        }

        .exercises-list,
        .quiz-questions,
        .evaluation-questions {
            max-height: 500px;
            overflow-y: auto;
        }

        .question-card {
            background: var(--bg-darker);
            border: 1px solid var(--border-color);
            border-radius: 8px;
            padding: 1rem;
            margin-bottom: 1rem;
            transition: all 0.3s ease;
        }

        .question-card:hover {
            background: var(--bg-card);
            transform: translateY(-1px);
        }

        .question-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 0.75rem;
        }

        .question-type-badge {
            font-size: 0.75rem;
            padding: 0.25rem 0.5rem;
            border-radius: 4px;
        }

        .evaluation-control-panel {
            background: linear-gradient(135deg, var(--warning), rgba(245, 158, 11, 0.8));
            color: white;
            border-radius: 8px;
            padding: 1.5rem;
        }

        .evaluation-control-panel .stat-label {
            color: rgba(255, 255, 255, 0.9);
        }

        .evaluation-control-panel .stat-value {
            color: white;
        }

        .launch-controls {
            background: var(--bg-darker);
            border-radius: 8px;
            padding: 1.5rem;
            border: 2px dashed var(--warning);
        }

        @media (max-width: 768px) {
            .pdf-preview-container {
                height: 400px;
            }

            .generation-info .row {
                text-align: center;
            }

            .stat-item {
                margin-bottom: 1rem;
            }
        }
    </style>

    <script>
        // Variables globales pour les sections
        let currentCourse = null;
        let currentExercise = null;
        let currentQuiz = null;
        let currentEvaluation = null;
        let isEditingCourse = false;
        let pdfZoomLevel = 100;

        // Section Cours - Fonctions
        function toggleCourseEditMode() {
            isEditingCourse = !isEditingCourse;
            const viewMode = document.getElementById('course-view-mode');
            const editMode = document.getElementById('course-edit-mode');
            const editBtn = document.getElementById('edit-course-btn');

            if (isEditingCourse) {
                viewMode.style.display = 'none';
                editMode.style.display = 'block';
                editBtn.innerHTML = '<i class="fas fa-eye"></i> Aperçu';

                // Pré-remplir le formulaire
                document.getElementById('edit-course-title').value = document.getElementById('display-course-title').textContent;
                document.getElementById('edit-course-description').value = document.getElementById('display-course-description').textContent;
            } else {
                viewMode.style.display = 'block';
                editMode.style.display = 'none';
                editBtn.innerHTML = '<i class="fas fa-edit"></i> Modifier';
            }
        }

        function cancelCourseEdit() {
            toggleCourseEditMode();
        }

        function downloadCourseFile() {
            const fileName = document.getElementById('display-file-name').textContent;
            // Simulation du téléchargement
            showMessage(`Téléchargement de ${fileName} en cours...`, 'info');
        }

        function openCourseInNewTab() {
            const pdfViewer = document.getElementById('course-pdf-viewer');
            if (pdfViewer.src) {
                window.open(pdfViewer.src, '_blank');
            }
        }

        function zoomIn() {
            pdfZoomLevel = Math.min(pdfZoomLevel + 25, 200);
            updatePdfZoom();
        }

        function zoomOut() {
            pdfZoomLevel = Math.max(pdfZoomLevel - 25, 50);
            updatePdfZoom();
        }

        function updatePdfZoom() {
            document.querySelector('.zoom-level').textContent = pdfZoomLevel + '%';
            const pdfViewer = document.getElementById('course-pdf-viewer');
            pdfViewer.style.transform = `scale(${pdfZoomLevel / 100})`;
        }

        function toggleFullscreen() {
            const pdfContainer = document.querySelector('.pdf-preview-container');
            if (!document.fullscreenElement) {
                pdfContainer.requestFullscreen();
            } else {
                document.exitFullscreen();
            }
        }

        // Gestion du fichier de cours
        document.getElementById('courseFileInput').addEventListener('change', function (e) {
            const file = e.target.files[0];
            if (file) {
                document.getElementById('newFileName').textContent = file.name;
                document.getElementById('newFileInfo').style.display = 'block';
                document.getElementById('replaceFileBtn').disabled = false;
            }
        });

        function clearNewFile() {
            document.getElementById('courseFileInput').value = '';
            document.getElementById('newFileInfo').style.display = 'none';
            document.getElementById('replaceFileBtn').disabled = true;
        }

        function replaceCourseFile() {
            const fileInput = document.getElementById('courseFileInput');
            const file = fileInput.files[0];

            if (!file) return;

            // Simulation de remplacement
            document.getElementById('display-file-name').textContent = file.name;
            document.getElementById('current-file-display').textContent = file.name;

            // Mettre à jour l'aperçu PDF
            const fileURL = URL.createObjectURL(file);
            document.getElementById('course-pdf-viewer').src = fileURL;

            showMessage('Fichier remplacé avec succès', 'success');
            bootstrap.Modal.getInstance(document.getElementById('replaceCourseFileModal')).hide();
            clearNewFile();
        }

        // Section Exercices - Fonctions
        function regenerateExercises() {
            const regenerationPanel = document.getElementById('regeneration-options');
            regenerationPanel.style.display = regenerationPanel.style.display === 'none' ? 'block' : 'none';
        }

        function hideRegenerationOptions() {
            document.getElementById('regeneration-options').style.display = 'none';
        }

        function confirmRegeneration() {
            const difficulty = document.getElementById('regen-difficulty').value;
            const count = document.getElementById('regen-count').value;
            const focus = document.getElementById('regen-focus').value;

            showMessage('Régénération des exercices en cours...', 'info');

            // Simulation de régénération
            setTimeout(() => {
                generateExercisesList(count, difficulty, focus);
                hideRegenerationOptions();
                showMessage(`${count} exercices régénérés avec succès`, 'success');
            }, 2000);
        }

        function generateExercisesList(count, difficulty, focus) {
            const container = document.getElementById('exercises-container');
            let exercisesHtml = '';

            for (let i = 1; i <= count; i++) {
                exercisesHtml += `
            <div class="question-card" data-exercise-id="${i}">
                <div class="question-header">
                    <div>
                        <span class="question-number">${i}</span>
                        <strong>Exercice ${i}</strong>
                        <span class="badge question-type-badge ms-2">${getRandomExerciseType()}</span>
                    </div>
                    <div class="btn-group btn-group-sm">
                        <button class="btn btn-outline-primary" onclick="editExercise(${i})">
                            <i class="fas fa-edit"></i>
                        </button>
                        <button class="btn btn-outline-danger" onclick="deleteExercise(${i})">
                            <i class="fas fa-trash"></i>
                        </button>
                    </div>
                </div>
                <div class="question-content">
                    <p>${generateRandomExerciseText(difficulty, focus)}</p>
                    <div class="question-meta">
                        <span class="text-muted">
                            <i class="fas fa-star me-1"></i>
                            ${Math.floor(Math.random() * 10) + 5} points
                        </span>
                        <span class="text-muted ms-3">
                            <i class="fas fa-clock me-1"></i>
                            ${Math.floor(Math.random() * 20) + 10} min
                        </span>
                    </div>
                </div>
            </div>
        `;
            }

            container.innerHTML = exercisesHtml;
        }

        function getRandomExerciseType() {
            const types = ['Pratique', 'Théorique', 'Application', 'Analyse'];
            return types[Math.floor(Math.random() * types.length)];
        }

        function generateRandomExerciseText(difficulty, focus) {
            const exercises = {
                facile: [
                    "Écrivez un algorithme simple de tri par sélection.",
                    "Implémentez une fonction de recherche linéaire.",
                    "Créez une structure de données pile basique."
                ],
                intermediaire: [
                    "Analysez la complexité temporelle de l'algorithme de tri rapide.",
                    "Implémentez un arbre binaire de recherche avec insertion et suppression.",
                    "Développez un algorithme de parcours en largeur pour un graphe."
                ],
                difficile: [
                    "Optimisez un algorithme de programmation dynamique pour le problème du sac à dos.",
                    "Implémentez un algorithme de plus court chemin avec mise à jour des poids.",
                    "Développez une solution efficace pour le problème de coloration de graphe."
                ]
            };

            const exerciseList = exercises[difficulty] || exercises.intermediaire;
            return exerciseList[Math.floor(Math.random() * exerciseList.length)];
        }

        function addCustomExercise() {
            showMessage('Ouverture de l\'éditeur d\'exercice personnalisé...', 'info');
            // Ici vous pourriez ouvrir un modal d'édition
        }

        function editExercise(exerciseId) {
            showMessage(`Édition de l'exercice ${exerciseId}`, 'info');
        }

        function deleteExercise(exerciseId) {
            if (confirm('Êtes-vous sûr de vouloir supprimer cet exercice ?')) {
                const exerciseElement = document.querySelector(`[data-exercise-id="${exerciseId}"]`);
                exerciseElement.remove();
                showMessage('Exercice supprimé', 'success');
            }
        }

        // Section Quiz - Fonctions
        function regenerateQuiz() {
            showMessage('Régénération du quiz en cours...', 'info');

            setTimeout(() => {
                generateQuizQuestions();
                showMessage('Quiz régénéré avec succès', 'success');
            }, 2000);
        }

        function generateQuizQuestions() {
            const container = document.getElementById('quiz-questions-container');
            const questionCount = 10;
            let questionsHtml = '';

            for (let i = 1; i <= questionCount; i++) {
                const questionType = getRandomQuestionType();
                questionsHtml += `
            <div class="question-card" data-question-id="${i}">
                <div class="question-header">
                    <div>
                        <span class="question-number">${i}</span>
                        <strong>Question ${i}</strong>
                        <span class="badge question-type-badge ms-2">${questionType}</span>
                    </div>
                    <div class="btn-group btn-group-sm">
                        <button class="btn btn-outline-primary" onclick="editQuizQuestion(${i})">
                            <i class="fas fa-edit"></i>
                        </button>
                        <button class="btn btn-outline-danger" onclick="deleteQuizQuestion(${i})">
                            <i class="fas fa-trash"></i>
                        </button>
                    </div>
                </div>
                <div class="question-content">
                    <p>${generateRandomQuestionText()}</p>
                    ${generateQuestionOptions(questionType)}
                    <div class="question-meta">
                        <span class="text-muted">
                            <i class="fas fa-star me-1"></i>
                            ${Math.floor(Math.random() * 5) + 1} points
                        </span>
                    </div>
                </div>
            </div>
        `;
            }

            container.innerHTML = questionsHtml;
        }

        function getRandomQuestionType() {
            const types = ['Choix multiple', 'Choix unique', 'Vrai/Faux'];
            return types[Math.floor(Math.random() * types.length)];
        }

        function generateRandomQuestionText() {
            const questions = [
                "Quelle est la complexité temporelle moyenne de l'algorithme de tri rapide ?",
                "Quel principe suit une structure de données pile ?",
                "Dans un arbre binaire équilibré, quelle est la hauteur maximale ?",
                "Quelle méthode de tri est considérée comme stable ?",
                "Qu'est-ce qui caractérise un graphe acyclique dirigé ?"
            ];
            return questions[Math.floor(Math.random() * questions.length)];
        }

        function generateQuestionOptions(type) {
            if (type === 'Vrai/Faux') {
                return `
            <div class="question-options">
                <div class="form-check">
                    <input class="form-check-input" type="radio" name="q${Date.now()}" disabled>
                    <label class="form-check-label">Vrai</label>
                </div>
                <div class="form-check">
                    <input class="form-check-input" type="radio" name="q${Date.now()}" disabled checked>
                    <label class="form-check-label">Faux</label>
                </div>
            </div>
        `;
            } else {
                const options = ['Option A', 'Option B', 'Option C', 'Option D'];
                const correctIndex = Math.floor(Math.random() * 4);

                return `
            <div class="question-options">
                ${options.map((option, index) => `
                    <div class="form-check">
                        <input class="form-check-input" type="radio" name="q${Date.now()}" disabled ${index === correctIndex ? 'checked' : ''}>
                        <label class="form-check-label ${index === correctIndex ? 'text-success fw-bold' : ''}">${option}</label>
                    </div>
                `).join('')}
            </div>
        `;
            }
        }

        function toggleQuizSettings() {
            const panel = document.getElementById('quiz-advanced-panel');
            panel.style.display = panel.style.display === 'none' ? 'block' : 'none';
        }

        function previewQuiz() {
            showMessage('Ouverture de l\'aperçu du quiz...', 'info');
        }

        function publishQuiz() {
            if (confirm('Êtes-vous sûr de vouloir publier ce quiz ? Il deviendra accessible aux étudiants.')) {
                document.getElementById('quiz-status').textContent = 'Publié';
                document.getElementById('quiz-status').className = 'badge badge-success';
                showMessage('Quiz publié avec succès', 'success');
            }
        }

        function editQuizQuestion(questionId) {
            showMessage(`Édition de la question ${questionId}`, 'info');
        }

        function deleteQuizQuestion(questionId) {
            if (confirm('Êtes-vous sûr de vouloir supprimer cette question ?')) {
                const questionElement = document.querySelector(`[data-question-id="${questionId}"]`);
                questionElement.remove();
                showMessage('Question supprimée', 'success');
            }
        }

        // Section Évaluation - Fonctions
        function regenerateEvaluation() {
            showMessage('Régénération de l\'évaluation en cours...', 'info');

            setTimeout(() => {
                generateEvaluationQuestions();
                showMessage('Évaluation régénérée avec succès', 'success');
            }, 2500);
        }

        function generateEvaluationQuestions() {
            const container = document.getElementById('evaluation-questions-container');
            const questionCount = 15;
            let questionsHtml = '';

            for (let i = 1; i <= questionCount; i++) {
                const questionType = getRandomQuestionType();
                const points = Math.floor(Math.random() * 10) + 5;

                questionsHtml += `
            <div class="question-card" data-eval-question-id="${i}">
                <div class="question-header">
                    <div>
                        <span class="question-number">${i}</span>
                        <strong>Question ${i}</strong>
                        <span class="badge question-type-badge ms-2">${questionType}</span>
                        <span class="badge badge-warning ms-1">${points} pts</span>
                    </div>
                    <div class="btn-group btn-group-sm">
                        <button class="btn btn-outline-primary" onclick="editEvaluationQuestion(${i})">
                            <i class="fas fa-edit"></i>
                        </button>
                        <button class="btn btn-outline-danger" onclick="deleteEvaluationQuestion(${i})">
                            <i class="fas fa-trash"></i>
                        </button>
                    </div>
                </div>
                <div class="question-content">
                    <p>${generateAdvancedQuestionText()}</p>
                    ${generateQuestionOptions(questionType)}
                    <div class="question-meta">
                        <span class="text-muted">
                            <i class="fas fa-star me-1"></i>
                            ${points} points
                        </span>
                        <span class="text-muted ms-3">
                            <i class="fas fa-clock me-1"></i>
                            ${Math.floor(Math.random() * 10) + 5} min recommandées
                        </span>
                    </div>
                </div>
            </div>
        `;
            }

            container.innerHTML = questionsHtml;
        }

        function generateAdvancedQuestionText() {
            const questions = [
                "Analysez l'efficacité de l'algorithme de Dijkstra par rapport à l'algorithme de Bellman-Ford.",
                "Démontrez la complexité temporelle de l'algorithme de tri par fusion en utilisant le théorème maître.",
                "Expliquez les avantages et inconvénients des structures de données basées sur les arbres B+.",
                "Comparez les stratégies de résolution de collisions dans les tables de hachage.",
                "Évaluez l'impact de la localité des données sur les performances des algorithmes de tri."
            ];
            return questions[Math.floor(Math.random() * questions.length)];
        }

        function toggleEvaluationSettings() {
            const panel = document.getElementById('evaluation-settings-panel');
            panel.style.display = panel.style.display === 'none' ? 'block' : 'none';
        }

        function launchEvaluation() {
            const launchControls = document.getElementById('launch-controls');
            launchControls.style.display = 'block';
            launchControls.scrollIntoView({ behavior: 'smooth' });
        }

        function hideLaunchControls() {
            document.getElementById('launch-controls').style.display = 'none';
        }

        function confirmLaunchEvaluation() {
            if (confirm('ATTENTION: Une fois lancée, l\'évaluation ne pourra plus être modifiée. Continuer ?')) {
                document.getElementById('eval-status').textContent = 'Active';
                document.getElementById('eval-status').className = 'badge badge-success';
                hideLaunchControls();
                showMessage('Évaluation lancée avec succès!', 'success');
            }
        }

        function previewEvaluation() {
            showMessage('Ouverture de l\'aperçu de l\'évaluation...', 'info');
        }

        function editEvaluationQuestion(questionId) {
            showMessage(`Édition de la question ${questionId} de l'évaluation`, 'info');
        }

        function deleteEvaluationQuestion(questionId) {
            if (confirm('Êtes-vous sûr de vouloir supprimer cette question de l\'évaluation ?')) {
                const questionElement = document.querySelector(`[data-eval-question-id="${questionId}"]`);
                questionElement.remove();
                showMessage('Question supprimée de l\'évaluation', 'success');
            }
        }

        // Fonctions de navigation
        function goBackToCourseList() {
            document.getElementById('course-details-section').style.display = 'none';
            // Afficher la vue précédente
        }

        function goBackToExerciseList() {
            document.getElementById('exercise-details-section').style.display = 'none';
            // Afficher la vue précédente
        }

        function goBackToQuizList() {
            document.getElementById('quiz-details-section').style.display = 'none';
            // Afficher la vue précédente
        }

        function goBackToEvaluationList() {
            document.getElementById('evaluation-details-section').style.display = 'none';
            // Afficher la vue précédente
        }

        // Fonction utilitaire pour les messages
        function showMessage(message, type = 'info') {
            const alertDiv = document.createElement('div');
            alertDiv.className = `alert alert-${type} alert-dismissible fade show position-fixed`;
            alertDiv.style.cssText = 'top: 20px; right: 20px; z-index: 9999; min-width: 300px;';
            alertDiv.innerHTML = `
        ${message}
        <button type="button" class="btn-close" onclick="this.parentElement.remove()"></button>
    `;
            document.body.appendChild(alertDiv);

            setTimeout(() => {
                if (alertDiv.parentNode) {
                    alertDiv.remove();
                }
            }, 5000);
        }

        // Initialisation des sections
        document.addEventListener('DOMContentLoaded', function () {
            // Initialiser les sections avec des données d'exemple
            generateExercisesList(8, 'intermediaire', 'general');
            generateQuizQuestions();
            generateEvaluationQuestions();

            // Charger un PDF d'exemple pour le cours
            const pdfViewer = document.getElementById('course-pdf-viewer');
            pdfViewer.src = 'https://www.w3.org/WAI/ER/tests/xhtml/testfiles/resources/pdf/dummy.pdf';
        });
    </script>
    <script>
        document.addEventListener('DOMContentLoaded', function () {
            const contentTypeSelect = document.getElementById('contentType');
            const courseFields = document.getElementById('courseFields');
            const aiFields = document.getElementById('aiFields');
            const exerciseSpecific = document.getElementById('exerciseSpecific');
            const evaluationSpecific = document.getElementById('evaluationSpecific');
            const submitBtn = document.getElementById('submitBtn');
            const submitText = document.getElementById('submitText');
            const submitLoader = document.getElementById('submitLoader');

            contentTypeSelect.addEventListener('change', function () {
                const selectedType = this.value;
                courseFields.style.display = 'none';
                aiFields.style.display = 'none';
                exerciseSpecific.style.display = 'none';
                evaluationSpecific.style.display = 'none';

                switch (selectedType) {
                    case 'cours':
                        courseFields.style.display = 'block';
                        submitText.textContent = 'Créer le cours';
                        break;
                    case 'exercice':
                        aiFields.style.display = 'block';
                        exerciseSpecific.style.display = 'block';
                        submitText.textContent = 'Générer les exercices';
                        break;
                    case 'quiz':
                        aiFields.style.display = 'block';
                        submitText.textContent = 'Générer le quiz';
                        break;
                    case 'evaluation':
                        aiFields.style.display = 'block';
                        evaluationSpecific.style.display = 'block';
                        submitText.textContent = 'Générer l\'évaluation';
                        break;
                }
            });

            document.getElementById('createContentForm').addEventListener('submit', async function (e) {
                e.preventDefault();

                const formData = new FormData(this);
                console.log('Form Data:', Object.fromEntries(formData.entries()));
                const contentType = formData.get('contentType');
                const moduleTitle = document.getElementById('module-title').textContent;
                const match = moduleTitle.match(/\(Code: ([^)]+)\)/);  // Utilisation d'une RegExp pour extraire le code
                const code = match ? match[1] : null;
                formData.append('module_code', code);  // Ajout du code du module au FormData
                courseFileInput = document.getElementById('courseFile');
                console.log('Selected file:', courseFileInput.files[0]);

                if (courseFileInput.files.length > 0) {
                    formData.append('file', courseFileInput.files[0]);
                }

                if (!contentType) {
                    showMessage('Veuillez sélectionner un type de contenu', 'warning');
                    return;
                }

                submitText.style.display = 'none';
                submitLoader.style.display = 'inline-block';
                submitBtn.disabled = true;

                try {
                    // 🚀 **Envoyer la requête POST au backend Django**
                    const response = await fetch('/api/create-content/', {
                        method: 'POST',
                        body: formData,
                        headers: {
                            'X-CSRFToken': getCsrfToken()  // Ajoute le token CSRF pour la sécurité
                        }
                    });

                    const data = await response.json();

                    if (response.ok && data.success) {
                        // ✅ **Ajout dynamique au front-end**
                        console.log('Contenu créé avec succès:', data.type);
                        const courseGrid = document.getElementById("module-content-list");
                        const newCard = createContentCard(data.type, data.content);
                        courseGrid.appendChild(newCard);

                        showMessage('Contenu ajouté avec succès !', 'success');
                        console.log(data.Feedback)
                        if (data.Feedback) {
                            const markdownHtml = marked.parse(data.Feedback);
                            document.getElementById('markdownContent').innerHTML = markdownHtml;
                            const markdownModal = new bootstrap.Modal(document.getElementById('markdownModal'));
                            markdownModal.show();
                        }

                        document.getElementById('createContentForm').reset();
                        bootstrap.Modal.getInstance(document.getElementById('createContentModal')).hide();
                    } else {
                        showMessage(data.error || 'Erreur lors de la création du contenu', 'danger');
                    }

                } catch (error) {
                    console.error('Erreur:', error);
                    showMessage('Erreur de connexion avec le serveur', 'danger');
                } finally {
                    submitText.style.display = 'inline-block';
                    submitLoader.style.display = 'none';
                    submitBtn.disabled = false;
                }
            });
        });

        function createContentCard(type, content) {
            const card = document.createElement('div');
            card.className = 'course-card';

            const icons = {
                'cours': 'fas fa-book',
                'exercice': 'fas fa-person-walking',
                'quiz': 'fas fa-question-circle',
                'evaluation': 'fas fa-star'
            };

            let metadata = `Code: ${content.code}`;
            if (type === 'cours') {
                metadata += ` • ${content.duration || 'N/A'}h`;
            } else {
                metadata += ` • ${content.questionCount || 'N/A'} questions`;
            }

            card.innerHTML = `
        <div class="course-image">
            <i class="${icons[type]}"></i>
        </div>
        <div class="course-content">
            <h4 class="course-title">${content.titre}</h4>
            <div class="course-meta">${metadata}</div>
            <div class="badge badge-info mb-2">${content.domain}</div>
            <div class="progress">
                <div class="progress-bar" style="width: 0%"></div>
            </div>
            <div class="course-actions mt-3">
                <button class="btn btn-sm btn-primary">
                    <i class="fas fa-edit"></i> Modifier
                </button>
                <button class="btn btn-sm btn-success">
                    <i class="fa-solid fa-comment-dots"></i> Feedback
                </button>
                <button class="btn btn-sm btn-info">
                    <i class="fas fa-eye"></i> Détails
                </button>
                <button class="btn btn-sm btn-danger">
                    <i class="fas fa-trash"></i> Supprimer
                </button>
            </div>
        </div>
    `;

            return card;
        }

        function showMessage(message, type = 'info') {
            const alertDiv = document.createElement('div');
            alertDiv.className = `alert alert-${type} alert-dismissible fade show position-fixed`;
            alertDiv.style.cssText = 'top: 20px; right: 20px; z-index: 9999; min-width: 300px;';
            alertDiv.innerHTML = `
        ${message}
        <button type="button" class="btn-close" onclick="this.parentElement.remove()"></button>
    `;
            document.body.appendChild(alertDiv);

            setTimeout(() => {
                if (alertDiv.parentNode) {
                    alertDiv.remove();
                }
            }, 5000);
        }

    </script>

    <!-- Scripts -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>

    <script>
        // Gestion du thème
        const themeToggle = document.getElementById('themeToggle');
        const themeIcon = document.getElementById('themeIcon');
        const themePreference = document.getElementById('themePreference');
        const html = document.documentElement;

        // Vérifier le thème système
        const systemTheme = window.matchMedia('(prefers-color-scheme: dark)').matches ? 'light' : 'dark';

        // Appliquer le thème sauvegardé ou le thème système
        function applyTheme(theme) {
            if (theme === 'system') {
                html.setAttribute('data-theme', systemTheme);
            } else {
                html.setAttribute('data-theme', theme);
            }

            // Mettre à jour l'icône
            const currentTheme = theme === 'system' ? systemTheme : theme;
            themeIcon.className = currentTheme === 'dark' ? 'fas fa-sun' : 'fas fa-moon';

            // Sauvegarder la préférence
            localStorage.setItem('theme', theme);
            themePreference.value = theme;
        }

        // Initialiser le thème
        const savedTheme = localStorage.getItem('theme') || 'dark';
        applyTheme(savedTheme);

        // Basculer entre les thèmes
        themeToggle.addEventListener('click', () => {
            const currentTheme = html.getAttribute('data-theme');
            const newTheme = currentTheme === 'dark' ? 'light' : 'dark';
            applyTheme(newTheme);
        });

        // Changer le thème via les préférences
        themePreference.addEventListener('change', (e) => {
            applyTheme(e.target.value);
        });

        // Gestion du menu mobile
        const mobileMenuToggle = document.getElementById('mobileMenuToggle');
        const sidebar = document.getElementById('sidebar');

        mobileMenuToggle.addEventListener('click', () => {
            sidebar.classList.toggle('mobile-open');
        });

        // Navigation entre les sections
        function showSection(sectionId) {
            // Masquer toutes les sections
            document.querySelectorAll('.content-section').forEach(section => {
                section.classList.remove('active');
            });

            // Afficher la section sélectionnée
            document.getElementById(sectionId).classList.add('active');

            // Mettre à jour le titre de la page
            const sectionTitle = document.querySelector(`[data-section="${sectionId}"] span`).textContent;
            document.getElementById('pageTitle').textContent = sectionTitle;

            // Mettre à jour l'élément actif du menu
            document.querySelectorAll('.menu-item').forEach(item => {
                item.classList.remove('active');
            });
            document.querySelector(`[data-section="${sectionId}"]`).classList.add('active');

            // Fermer le menu mobile si ouvert
            sidebar.classList.remove('mobile-open');

            // Initialiser les graphiques si nécessaire
            if (sectionId === 'statistics') {
                initCharts();
            }
        }

        // Ajouter des écouteurs d'événements aux éléments du menu
        document.querySelectorAll('.menu-item').forEach(item => {
            item.addEventListener('click', () => {
                const sectionId = item.getAttribute('data-section');
                showSection(sectionId);
            });
        });

        // Initialiser les graphiques
        function initCharts() {
            // Performance par cours
            const coursePerformanceCtx = document.getElementById('coursePerformanceChart').getContext('2d');
            const coursePerformanceChart = new Chart(coursePerformanceCtx, {
                type: 'bar',
                data: {
                    labels: ['Algorithmique', 'Base de données', 'IA', 'Réseaux', 'Sécurité'],
                    datasets: [{
                        label: 'Moyenne des notes',
                        data: [75, 82, 88, 79, 85],
                        backgroundColor: '#8B7355',
                        borderColor: '#6B5842',
                        borderWidth: 1
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    scales: {
                        y: {
                            beginAtZero: true,
                            max: 100,
                            ticks: {
                                callback: function (value) {
                                    return value + '%';
                                }
                            }
                        }
                    }
                }
            });

            // Évolution des inscriptions
            const enrollmentCtx = document.getElementById('enrollmentChart').getContext('2d');
            const enrollmentChart = new Chart(enrollmentCtx, {
                type: 'line',
                data: {
                    labels: ['Jan', 'Fév', 'Mar', 'Avr', 'Mai', 'Juin'],
                    datasets: [{
                        label: 'Inscriptions',
                        data: [45, 60, 75, 90, 110, 130],
                        fill: true,
                        backgroundColor: 'rgba(139, 115, 85, 0.1)',
                        borderColor: '#8B7355',
                        tension: 0.3
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false
                }
            });
        }

        // Gestion du formulaire de génération de quiz
        const quizGeneratorForm = document.getElementById('quizGeneratorForm');
        const generationResult = document.getElementById('generationResult');

        quizGeneratorForm.addEventListener('submit', (e) => {
            e.preventDefault();

            // Afficher l'indicateur de chargement
            const submitButton = quizGeneratorForm.querySelector('button[type="submit"]');
            const originalText = submitButton.innerHTML;
            submitButton.innerHTML = '<span class="loading"></span> Génération en cours...';
            submitButton.disabled = true;

            // Simuler une requête API
            setTimeout(() => {
                // Afficher le résultat
                generationResult.style.display = 'block';
                submitButton.innerHTML = originalText;
                submitButton.disabled = false;

                // Faire défiler jusqu'au résultat
                generationResult.scrollIntoView({ behavior: 'smooth' });
            }, 2000);
        });

        // Aperçu des paramètres du quiz
        function previewQuizSettings() {
            const previewModal = new bootstrap.Modal(document.getElementById('previewQuizModal'));
            previewModal.show();
        }

        // Ouvrir le modal de création de cours
        function openCreateCourseModal() {
            const createCourseModal = new bootstrap.Modal(document.getElementById('createCourseModal'));
            createCourseModal.show();
        }

        // Initialiser les graphiques au chargement si sur la page des statistiques
        document.addEventListener('DOMContentLoaded', () => {
            if (document.getElementById('statistics').classList.contains('active')) {
                initCharts();
            }
        });
    </script>
    <script>
        async function showModuleDetails(title, code) {
            // Cacher la section principale
            const coursesSection = document.getElementById("courses");
            coursesSection.classList.add("d-none");

            // Afficher la section détails
            const moduleDetails = document.getElementById('module-details');
            moduleDetails.classList.remove('d-none');
            moduleDetails.classList.add('d-flex');

            // Mettre à jour le titre du module
            document.getElementById('module-title').textContent = title + " (Code: " + code + ")";

            try {
                // Envoyer une requête AJAX à Django pour récupérer les détails du module
                const response = await fetch(`/api/module-details/${code}/`);
                const data = await response.json();
                console.log("Détails du module :", data);
                if (response.ok) {
                    const moduleContentList = document.getElementById('module-content-list');
                    moduleContentList.innerHTML = ""; // Vider la liste avant d'ajouter les éléments

                    // 🔹 Ajouter les cours
                    data.cours.forEach(cours => {
                        console.log("Cours:", cours);
                        const courseCard = createModuleCard("cours", cours.titre, code, "fas fa-book", "Cours", cours.file_url ? cours.file : null, cours.code ?? null);
                        moduleContentList.appendChild(courseCard);
                    });

                    // 🔹 Ajouter les exercices
                    data.exercices.forEach(exercice => {
                        const exerciceCard = createModuleCard("exercice", exercice.titre, code, "fas fa-dumbbell", "Exercice", null, exercice);
                        moduleContentList.appendChild(exerciceCard);
                        const questions = exercice;
                        console.log("Exercice Questions=>: ", questions);
                    });

                    // 🔹 Ajouter les quiz
                    data.quizz.forEach(quiz => {
                        const quizCard = createModuleCard("quiz", quiz.question, code, "fas fa-question-circle", "Quiz");
                        moduleContentList.appendChild(quizCard);
                    });

                    // 🔹 Ajouter les évaluations
                    data.evaluations.forEach(evaluation => {
                        const evaluationCard = createModuleCard("evaluation", evaluation.titre, code, "fas fa-star", "Évaluation");
                        moduleContentList.appendChild(evaluationCard);
                    });

                } else {
                    moduleContentList.innerHTML = `<p class="text-danger">Erreur de chargement des détails.</p>`;
                }


            } catch (error) {
                console.error("Erreur lors de la récupération des détails :", error);
                document.getElementById('module-content-list').innerHTML = `<p class="text-danger">Impossible de charger les données.</p>`;
            }

            // 🔥 Fonction générique pour créer une carte de module
            function createModuleCard(type, title, code, iconClass, badgeText, fileUrl = null, data = null) {
                console.log("Data Exercice: ", data)
                console.log("Lien: ", fileUrl);
                console.log("Type: ", type);
                const card = document.createElement("div");
                let code_cours = null;
                card.className = "course-card";
                card.setAttribute("data-type", type);
                card.setAttribute("data-title", title);
                card.setAttribute("data-code", code);
                if (type == 'exercice') {
                    card.setAttribute("data-exercice", JSON.stringify(data));
                }
                if (type == 'cours') {
                    code_cours = data
                }



                card.innerHTML = `
        <div class="course-image">
            <i class="${iconClass}"></i>
        </div>
        <div class="course-content">
            <h4 class="course-title">${title}</h4>
            <div class="course-meta">Code: ${code}</div>
            <div class="badge badge-info mb-2">${badgeText}</div>
            <div class="progress">
                <div class="progress-bar" style="width: 0%"></div>
            </div>
            <div class="course-actions mt-3">
               <button class="btn btn-sm btn-success btn-feedback" data-code="${code_cours}">
                <i class="fa-solid fa-comment-dots"></i> Feedback
            </button>

                <button class="btn btn-sm btn-secondary">
                  <i class="fa-solid fa-pen-to-square"></i> Modifier
                </button>
                
               <button class="btn btn-sm btn-info show-details-btn">
  <i class="fas fa-eye"></i> Détails
</button>

                <button class="btn btn-sm btn-danger">
                    <i class="fas fa-trash"></i> Supprimer
                </button>
            </div>
        </div>
    `;
                const detailsBtn = card.querySelector(".show-details-btn");
                if (type == 'exercice') {
                    detailsBtn.addEventListener("click", () => {
                        const exerciceData = JSON.parse(card.getAttribute("data-exercice"));
                        showContentDetails(type, title, code, fileUrl, exerciceData);
                    });
                } else if (type == 'cours') {
                    detailsBtn.addEventListener("click", () => {
                        showContentDetails(type, title, code, fileUrl);
                    });
                }


                return card;
            }
        }

        // Retour aux modules
        function backToModules() {
            document.getElementById('module-details').classList.add('d-none');
            document.getElementById('courses').classList.remove('d-none');
        }


        function goBackTocontentList(titre, code) {
            const moduleContentList = document.getElementById('content-list');
            const card = document.getElementById('content-card');
            card.innerHTML = ""; // Vider le contenu de la carte
            document.getElementById('module-content-list').classList.remove('d-none');;
            // Afficher la carte de contenu

            showModuleDetails(titre, code);
        }



        function afficherExercices(body, exercices) {
            body.innerHTML = ""; // On vide d'abord le contenu

            exercices.forEach((exercice, index) => {
                const i = index + 1;
                const questionHTML = `
            <div class="question-card" data-exercise-id="${i}">
                <div class="question-header d-flex justify-content-between align-items-center">
                    <div>
                        <span class="question-number">${i}</span>
                        <strong>Exercice ${i}</strong>
                        <span class="badge question-type-badge ms-2">Exercice</span>
                    </div>
                    <div class="btn-group btn-group-sm">
                        <button class="btn btn-outline-primary" onclick="editExercise(${i})">
                            <i class="fas fa-edit"></i>
                        </button>
                        <button class="btn btn-outline-danger" onclick="deleteExercise(${i})">
                            <i class="fas fa-trash"></i>
                        </button>
                    </div>
                </div>
                <div class="question-content mt-2">
                    <p>${exercice.question}</p>
                    <div class="question-meta">
                        <span class="text-muted">
                            <i class="fas fa-star me-1"></i>
                            10 points
                        </span>
                        <span class="text-muted ms-3">
                            <i class="fas fa-clock me-1"></i>
                            5 min
                        </span>
                    </div>
                </div>
            </div>
        `;
                body.innerHTML += questionHTML;
            });
            return body;
        }

        function showContentDetails(type, title, code, fileUrl = null, data = null) {
            const moduleContentList = document.getElementById('content-list');
            const moduleDetailslistcontent = document.getElementById('module-content-list');
            const card = document.getElementById('content-card');
            console.log("Data Details: ", data);
            moduleDetailslistcontent.classList.add('d-none');
            card.innerHTML = ''; // Vider l'ancien contenu
            console.log("Type de contenu:", type);


            // console.log("Détails de l'exercice :", exerciceData);

            if (type === "exercice" && data) {

                const exerciceData = data;
                const header = document.createElement('div');
                header.className = 'card-header'; // Ton bloc exercice existant ici

                header.innerHTML = `
                <div class="card w-100">
                    <div class="card-header">
                        <div class="d-flex justify-content-between align-items-center">
                            <div>
                                <h4 id="exercise-title">Exercices Pratiques</h4>
                                <span class="badge badge-warning">Exercices</span>
                                <span class="badge badge-success ms-2">
                                    <i class="fas fa-robot me-1"></i>
                                    Généré par IA
                                </span>
                            </div>
                            <div class="btn-group">
                                <button class="btn btn-outline-secondary" onclick="goBackToExerciseList()">
                                    <i class="fas fa-arrow-left"></i>
                                    Retour
                                </button>
                                <button class="btn btn-success" onclick="regenerateExercises()">
                                    <i class="fas fa-sync-alt"></i>
                                    Régénérer
                                </button>
                                <button class="btn btn-primary" onclick="addCustomExercise()">
                                    <i class="fas fa-plus"></i>
                                    Ajouter
                                </button>
                            </div>
                        </div>
                    </div>
                    <div class="card-body">
                        <!-- Paramètres de génération -->
                        <div class="generation-info mb-4">
                            <div class="row">
                                <div class="col-md-3">
                                    <div class="stat-item">
                                        <span class="stat-label">Difficulté</span>
                                        <span class="stat-value" id="exercise-difficulty">Intermédiaire</span>
                                    </div>
                                </div>
                                <div class="col-md-3">
                                    <div class="stat-item">
                                        <span class="stat-label">Nombre d'exercices</span>
                                        <span class="stat-value" id="exercise-count">8</span>
                                    </div>
                                </div>
                                <div class="col-md-3">
                                    <div class="stat-item">
                                        <span class="stat-label">Basé sur</span>
                                        <span class="stat-value" id="exercise-source">Cours PDF</span>
                                    </div>
                                </div>
                                <div class="col-md-3">
                                    <div class="stat-item">
                                        <span class="stat-label">Généré le</span>
                                        <span class="stat-value" id="exercise-generated-date">20 Jan 2024</span>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- Options de régénération -->
                        <div class="regeneration-panel mb-4" style="display: none;" id="regeneration-options">
                            <div class="card">
                                <div class="card-body">
                                    <h6>Options de Régénération</h6>
                                    <div class="row">
                                        <div class="col-md-4">
                                            <label class="form-label">Difficulté</label>
                                            <select class="form-select" id="regen-difficulty">
                                                <option value="facile">Facile</option>
                                                <option value="intermediaire" selected>Intermédiaire</option>
                                                <option value="difficile">Difficile</option>
                                            </select>
                                        </div>
                                        <div class="col-md-4">
                                            <label class="form-label">Nombre d'exercices</label>
                                            <input type="number" class="form-control" id="regen-count" value="8" min="1"
                                                max="20">
                                        </div>
                                        <div class="col-md-4">
                                            <label class="form-label">Focus sur</label>
                                            <select class="form-select" id="regen-focus">
                                                <option value="general">Général</option>
                                                <option value="pratique">Pratique</option>
                                                <option value="theorie">Théorie</option>
                                                <option value="application">Application</option>
                                            </select>
                                        </div>
                                    </div>
                                    <div class="mt-3">
                                        <button class="btn btn-outline-secondary btn-sm"
                                            onclick="hideRegenerationOptions()">Annuler</button>
                                        <button class="btn btn-success btn-sm" onclick="confirmRegeneration()">
                                            <i class="fas fa-magic"></i>
                                            Générer
                                        </button>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- Liste des exercices -->
                        <div class="exercises-list" id="exercises-container">
                            <!-- Exercices générés dynamiquement -->
                        </div>
                    </div>
                </div>
                `
                card.appendChild(header);
                const body = document.createElement('div');

                body.className = 'card-body';
                body.innerHTML = ``

                const questions = exerciceData.question;
                if (Array.isArray(questions)) {
                    questions.forEach((q, index) => {
                        console.log(`Question ${index + 1}:`, q);



                        const questionHTML = `
            <div class="question-card" data-exercise-id="${index + 1}">
                <div class="question-header d-flex justify-content-between align-items-center">
                    <div>
                        <!-- span class="question-number">${index + 1}</span -->
                        <strong>Question ${index + 1}</strong>
                        <span class="badge question-type-badge ms-2">Exercice</span>
                    </div>
                    <div class="btn-group btn-group-sm">
                        <button class="btn btn-outline-primary" onclick="editExercise(${index + 1})">
                            <i class="fas fa-edit"></i>
                        </button>
                        <button class="btn btn-outline-danger" onclick="deleteExercise(${index + 1})">
                            <i class="fas fa-trash"></i>
                        </button>
                    </div>
                </div>
                <div class="question-content mt-2">
                    <p>${q}</p>
                    <div class="question-meta">
                        <span class="text-muted">
                            <i class="fas fa-star me-1"></i>
                            10 points
                        </span>
                        <span class="text-muted ms-3">
                            <i class="fas fa-clock me-1"></i>
                            5 min
                        </span>
                    </div>
                </div>
            </div>
        `;
                        body.innerHTML += questionHTML;
                        // Tu peux l'afficher dans le DOM ici
                    });
                }
                //    body =  afficherExercices(body, exerciceData);
                console.log("Body: ", body);
                card.appendChild(body);
            }

            if (type === 'quiz') {
                // À compléter si nécessaire
                return;
            }
            if (type === 'evaluation') {
                // À compléter si nécessaire
                return;
            }

            if (type === 'cours') {
                const header = document.createElement('div');
                header.className = 'card-header';
                header.innerHTML = `
            <div class="d-flex justify-content-between align-items-center">
                <div>
                    <h4 id="course-title"></h4>
                    <span class="badge badge-info"></span>
                </div>
                <div class="btn-group">
                    <button class="btn btn-outline-secondary" id="back-btn" onclick="goBackTocontentList('${title}', '${code}')">
                        <i class="fas fa-arrow-left"></i> Retour
                    </button>
                    <button class="btn btn-primary" id="edit-course-btn">
                        <i class="fas fa-edit"></i> Modifier
                    </button>
                </div>
            </div>
        `;
                card.appendChild(header);

                const body = document.createElement('div');
                body.className = 'card-body';
                body.innerHTML = `
            <div id="course-view-mode">
                <div class="row">
                    <div class="col-md-4">
                        <div class="course-info-panel">
                            <h5>Informations du Cours</h5>
                            <div class="info-item"><strong>Titre :</strong> <span id="display-course-title"></span></div>
                            <div class="info-item"><strong>Description :</strong> <span id="display-course-description">Ce cours couvre les concepts fondamentaux des algorithmes...</span></div>
                            <div class="info-item"><strong>Fichier :</strong> <span id="display-file-name">Fichier non défini</span></div>
                            <div class="info-item"><strong>Taille :</strong> <span id="display-file-size">-</span></div>
                            <div class="info-item"><strong>Dernière modification :</strong> <span id="display-last-modified">-</span></div>
                            <div class="file-actions mt-3">
                                <button class="btn btn-success btn-sm" id="download-btn"><i class="fas fa-download"></i> Télécharger</button>
                                <a class="btn btn-info btn-sm" href="${fileUrl.startsWith('http') ? fileUrl : window.location.origin + '/media/' + fileUrl}" target="_blank" id="open-btn">
    <i class="fas fa-external-link-alt"></i> Ouvrir
</a>

                            </div>
                            <div class="mt-3">
                                <button class="btn btn-warning btn-sm" data-bs-toggle="modal" data-bs-target="#replaceCourseFileModal"><i class="fas fa-upload"></i> Remplacer</button>
                            </div>
                        </div>
                    </div>
                    <div class="col-md-8">
                        <div class="pdf-preview-container">
                            <div class="pdf-toolbar">
                                <div class="d-flex justify-content-between align-items-center">
                                    <h6 class="mb-0">Aperçu du Document</h6>
                                    <div class="pdf-controls">
                                        <button class="btn btn-sm btn-outline-secondary" id="zoom-out-btn"><i class="fas fa-search-minus"></i></button>
                                        <span class="zoom-level">100%</span>
                                        <button class="btn btn-sm btn-outline-secondary" id="zoom-in-btn"><i class="fas fa-search-plus"></i></button>
                                        <button class="btn btn-sm btn-outline-secondary" id="fullscreen-btn"><i class="fas fa-expand"></i></button>
                                    </div>
                                </div>
                            </div>
                            <div class="pdf-viewer-wrapper">
                                <iframe id="course-pdf-viewer" src="${fileUrl}" class="course-pdf-display" frameborder="0"></iframe>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <div id="course-edit-mode" style="display: none;">
                <form id="course-edit-form">
                    <div class="row">
                        <div class="col-md-6 mb-3">
                            <label class="form-label">Titre du Cours</label>
                            <input type="text" class="form-control" id="edit-course-title" required>
                        </div>
                        <div class="col-md-6 mb-3">
                            <label class="form-label">Code du Cours</label>
                            <input type="text" class="form-control" id="edit-course-code" required>
                        </div>
                    </div>
                    <div class="mb-3">
                        <label class="form-label">Description</label>
                        <textarea class="form-control" id="edit-course-description" rows="4"></textarea>
                    </div>
                    <div class="mb-3">
                        <label class="form-label">Fichier du Cours</label>
                        <div class="alert alert-info">
                            <i class="fas fa-file-pdf me-2"></i>
                            <span id="current-file-display">Aucun</span>
                            <button type="button" class="btn btn-sm btn-outline-primary ms-2" data-bs-toggle="modal" data-bs-target="#replaceCourseFileModal">Changer le fichier</button>
                        </div>
                    </div>
                    <div class="edit-actions">
                        <button type="button" class="btn btn-outline-secondary" id="cancel-edit-btn">Annuler</button>
                        <button type="submit" class="btn btn-primary"><i class="fas fa-save"></i> Sauvegarder</button>
                    </div>
                </form>
            </div>
        `;
                card.appendChild(body);

                // Remplir les champs dynamiques
                document.getElementById('course-title').textContent = title;
                document.querySelector('.badge-info').textContent = type;
                document.getElementById('display-course-title').textContent = title;
                document.getElementById('edit-course-title').value = title;
                document.getElementById('edit-course-code').value = code;

                if (fileUrl) {
                    const fileName = fileUrl.split('/').pop();
                    document.getElementById('display-file-name').textContent = fileName;
                    document.getElementById('current-file-display').textContent = fileName;
                    document.getElementById('course-pdf-viewer').src = fileUrl;

                    document.getElementById('download-btn').addEventListener('click', () => {
                        window.open(fileUrl, '_blank');
                    });
                    document.getElementById('open-btn').addEventListener('click', () => {
                        window.open(fileUrl, '_blank');
                    });
                } else {
                    document.getElementById('download-btn').disabled = true;
                    document.getElementById('open-btn').disabled = true;
                }

                // Événements supplémentaires
                document.getElementById('edit-course-btn').addEventListener('click', toggleCourseEditMode);
                document.getElementById('cancel-edit-btn').addEventListener('click', cancelCourseEdit);
                document.getElementById('course-edit-form').addEventListener('submit', saveCourseChanges);
                document.getElementById('zoom-in-btn').addEventListener('click', zoomIn);
                document.getElementById('zoom-out-btn').addEventListener('click', zoomOut);
                document.getElementById('fullscreen-btn').addEventListener('click', toggleFullscreen);
            }
        }


    </script>
    <script>
        function openCreateContentModal() {
            const modal = new bootstrap.Modal(document.getElementById('createContentModal'));
            modal.show();
        }


    </script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/dompurify/2.4.3/purify.min.js"></script>

<script>
    
        document.addEventListener('click', async function (e) {
    if (e.target.closest('.btn-feedback')) {
        const button = e.target.closest('.btn-feedback');
        const code = button.getAttribute('data-code');

        try {
            const response = await fetch(`/api/get-feedback/${code}/`);
            const data = await response.json();

            if (response.ok && data.feedback) {
                const markdownHtml = marked.parse(data.feedback);
                document.getElementById('markdownContent').innerHTML = DOMPurify.sanitize(markdownHtml);

                const markdownModal = new bootstrap.Modal(document.getElementById('markdownModal'));
                markdownModal.show();
            } else {
                showMessage("Aucun feedback disponible", "warning");
            }
        } catch (error) {
            console.error(error);
            showMessage("Erreur lors de la récupération du feedback", "danger");
        }
    }
});

</script>

</body>

</html>